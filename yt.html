<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTube Real App</title>
    <!-- 폰트 및 아이콘 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,300,0,0" />
    
    <style>
        /* --- 1. CSS Reset & Variables --- */
        :root {
            --bg-color: #0f0f0f;
            --header-bg: rgba(15, 15, 15, 0.98);
            --text-main: #fff;
            --text-sub: #aaa;
            --nav-height: 48px;
            --bottom-nav-height: 50px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg-color); color: var(--text-main); overflow: hidden; height: 100vh; width: 100vw; }

        /* 아이콘 스타일 */
        .material-symbols-outlined { font-size: 24px; color: #fff; }
        .filled { font-variation-settings: 'FILL' 1; }

        /* --- 2. 상단 헤더 & 검색바 --- */
        header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--nav-height);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 12px; z-index: 100; background-color: var(--header-bg);
        }

        .logo-section { display: flex; align-items: center; gap: 4px; }
        .yt-logo-icon { color: #f00; font-size: 28px; }
        .yt-logo-text { font-weight: 700; font-size: 20px; letter-spacing: -0.5px; position: relative; top: -1px; }

        .header-icons { display: flex; gap: 18px; align-items: center; }
        .icon-btn { background: none; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; }

        /* 검색 모드 오버레이 헤더 */
        #search-header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--nav-height);
            background-color: #212121; z-index: 101; display: flex; align-items: center;
            padding: 0 8px; gap: 8px; transform: translateY(-100%); transition: transform 0.2s ease;
        }
        #search-header.active { transform: translateY(0); }
        
        .search-input-wrapper {
            flex: 1; background: #121212; height: 36px; border-radius: 18px;
            display: flex; align-items: center; padding: 0 12px;
        }
        #search-input {
            width: 100%; background: transparent; border: none; color: #fff; outline: none; font-size: 16px;
        }

        /* --- 3. 메인 컨텐츠 (스크롤 영역) --- */
        #main-scroll-area {
            height: 100%; overflow-y: auto; padding-top: var(--nav-height); padding-bottom: var(--bottom-nav-height);
        }
        #main-scroll-area::-webkit-scrollbar { display: none; }

        /* 카테고리 칩 */
        .chips-bar {
            display: flex; gap: 8px; padding: 8px 12px; overflow-x: auto;
            position: sticky; top: 0; background-color: var(--bg-color); z-index: 90;
        }
        .chips-bar::-webkit-scrollbar { display: none; }
        .chip {
            background: #272727; padding: 6px 12px; border-radius: 8px; white-space: nowrap; font-size: 14px; font-weight: 500;
        }
        .chip.active { background: #fff; color: #000; }

        /* 비디오 리스트 스타일 */
        .video-card { margin-bottom: 24px; cursor: pointer; }
        .thumbnail-box { position: relative; width: 100%; aspect-ratio: 16/9; background: #1f1f1f; }
        .thumbnail-box img { width: 100%; height: 100%; object-fit: cover; }
        .time-badge {
            position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8);
            color: #fff; font-size: 12px; padding: 2px 4px; border-radius: 4px; font-weight: 500;
        }
        .info-box { display: flex; padding: 12px 12px 0; }
        .channel-img { width: 36px; height: 36px; border-radius: 50%; background: #333; margin-right: 12px; overflow: hidden; flex-shrink: 0; }
        .channel-img img { width: 100%; height: 100%; object-fit: cover; }
        .text-area { flex: 1; padding-right: 16px; }
        .v-title { font-size: 16px; font-weight: 500; line-height: 1.3; margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .v-meta { font-size: 12px; color: var(--text-sub); }

        /* --- 4. 영상 재생 화면 (Watch Page) --- */
        #watch-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); z-index: 2000;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0, 0, 1);
            display: flex; flex-direction: column;
        }
        #watch-page.open { transform: translateY(0); }

        .player-wrapper { width: 100%; aspect-ratio: 16/9; background: #000; position: sticky; top: 0; z-index: 10; }
        iframe { width: 100%; height: 100%; border: none; }

        .watch-content { flex: 1; overflow-y: auto; padding: 12px; }
        .watch-title { font-size: 18px; font-weight: 700; margin-bottom: 8px; line-height: 1.3; }
        .watch-meta { font-size: 12px; color: var(--text-sub); display: flex; justify-content: space-between; margin-bottom: 12px; }
        
        .action-bar { display: flex; justify-content: space-around; margin-bottom: 16px; }
        .action-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: #fff; font-size: 12px; }
        .action-icon { background: #272727; width: 40px; height: 40px; border-radius: 20px; display: flex; align-items: center; justify-content: center; }

        .channel-row { display: flex; align-items: center; justify-content: space-between; border-top: 1px solid #272727; border-bottom: 1px solid #272727; padding: 12px 0; margin-bottom: 12px; }
        .ch-info { display: flex; align-items: center; gap: 10px; }
        .sub-btn { background: #fff; color: #000; padding: 8px 16px; border-radius: 18px; font-size: 14px; font-weight: 600; }

        /* 닫기 버튼 (재생 화면 닫기) */
        .close-player-btn {
            position: absolute; top: 8px; left: 8px; z-index: 20; color: white; background: rgba(0,0,0,0.5); border-radius: 50%; padding: 4px;
            display: none; /* 아래로 스와이프 구현 대신 버튼으로 대체 */
        }

        /* --- 5. 하단 내비게이션 --- */
        nav.bottom-nav {
            position: fixed; bottom: 0; width: 100%; height: var(--bottom-nav-height);
            background: var(--bg-color); border-top: 1px solid #272727;
            display: flex; justify-content: space-around; align-items: center; z-index: 99;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; flex: 1; color: #fff; font-size: 10px; opacity: 0.7; }
        .nav-item.active { opacity: 1; }
        .nav-item .material-symbols-outlined { font-size: 24px; margin-bottom: 2px; }

        /* 로더 */
        .loader { text-align: center; padding: 20px; color: #aaa; }
    </style>
</head>
<body>

    <!-- 1. 일반 헤더 -->
    <header id="main-header">
        <div class="logo-section" onclick="location.reload()">
            <span class="material-symbols-outlined filled yt-logo-icon">play_arrow</span>
            <span class="yt-logo-text">YouTube</span>
        </div>
        <div class="header-icons">
            <button class="icon-btn"><span class="material-symbols-outlined">cast</span></button>
            <button class="icon-btn"><span class="material-symbols-outlined">notifications</span></button>
            <button class="icon-btn" onclick="toggleSearch()"><span class="material-symbols-outlined">search</span></button>
        </div>
    </header>

    <!-- 2. 검색 헤더 (토글됨) -->
    <div id="search-header">
        <button class="icon-btn" onclick="toggleSearch()"><span class="material-symbols-outlined">arrow_back</span></button>
        <div class="search-input-wrapper">
            <input type="text" id="search-input" placeholder="YouTube 검색" onkeypress="handleEnter(event)">
        </div>
        <button class="icon-btn" onclick="performSearch()"><span class="material-symbols-outlined">search</span></button>
    </div>

    <!-- 3. 메인 스크롤 영역 -->
    <div id="main-scroll-area">
        <!-- 필터 칩 -->
        <div class="chips-bar">
            <div class="chip active">전체</div>
            <div class="chip">게임</div>
            <div class="chip">음악</div>
            <div class="chip">라이브</div>
            <div class="chip">요리</div>
        </div>

        <!-- 비디오 리스트 컨테이너 -->
        <div id="video-list">
            <!-- JS로 채워짐 -->
            <div class="loader">로딩 중...</div>
        </div>
    </div>

    <!-- 4. 영상 재생 페이지 (오버레이) -->
    <div id="watch-page">
        <!-- 뒤로가기 버튼 역할 (헤더처럼 보이게) -->
        <div style="padding: 10px; background: #000; display:flex; align-items: center;">
            <span class="material-symbols-outlined" onclick="closePlayer()" style="cursor: pointer;">keyboard_arrow_down</span>
        </div>
        
        <div class="player-wrapper">
            <div id="player-placeholder" style="width:100%; height:100%;"></div>
        </div>
        
        <div class="watch-content">
            <div class="watch-title" id="wp-title">제목 로딩중...</div>
            <div class="watch-meta" id="wp-meta">조회수 • 시간</div>
            
            <div class="channel-row">
                <div class="ch-info">
                    <div class="channel-img" style="width:32px; height:32px;">
                        <img id="wp-channel-img" src="" alt="">
                    </div>
                    <strong id="wp-channel-name" style="font-size:14px;">채널명</strong>
                </div>
                <div class="sub-btn">구독</div>
            </div>

            <div class="action-bar">
                <div class="action-item"><div class="action-icon"><span class="material-symbols-outlined">thumb_up</span></div>좋아요</div>
                <div class="action-item"><div class="action-icon"><span class="material-symbols-outlined">share</span></div>공유</div>
                <div class="action-item"><div class="action-icon"><span class="material-symbols-outlined">download</span></div>오프라인</div>
                <div class="action-item"><div class="action-icon"><span class="material-symbols-outlined">library_add</span></div>저장</div>
            </div>
            
            <div style="background: #272727; padding: 12px; border-radius: 12px; font-size: 13px;">
                <p style="font-weight: bold; margin-bottom: 4px;">댓글</p>
                <p>이 영상 진짜 대박이네요! 디자인이 유튜브랑 똑같아요 ㅋㅋ</p>
            </div>
        </div>
    </div>

    <!-- 5. 하단 내비게이션 -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="location.reload()">
            <span class="material-symbols-outlined filled">home</span>
            <span>홈</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">slow_motion_video</span>
            <span>Shorts</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined" style="font-size: 32px; font-weight: 200;">add_circle</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">subscriptions</span>
            <span>구독</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">account_circle</span>
            <span>나</span>
        </div>
    </nav>

    <script>
        const API_KEY = 'AIzaSyD9gpmEbUyP9h9Rm3nayK7PLYek5Ja7B38'; // 사용자 제공 키
        const VIDEO_LIST = document.getElementById('video-list');
        const WATCH_PAGE = document.getElementById('watch-page');
        const PLAYER_CONTAINER = document.getElementById('player-placeholder');

        // --- 초기 실행: 인기 동영상 로드 ---
        loadPopularVideos();

        // --- 기능 1: 인기 동영상 가져오기 ---
        async function loadPopularVideos() {
            VIDEO_LIST.innerHTML = '<div class="loader">인기 동영상 불러오는 중...</div>';
            try {
                const res = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&chart=mostPopular&maxResults=10&regionCode=KR&key=${API_KEY}`);
                const data = await res.json();
                renderVideos(data.items);
            } catch (e) {
                console.error(e);
                VIDEO_LIST.innerHTML = `<div class="loader">API 오류 발생 (할당량 초과 가능성)</div>`;
            }
        }

        // --- 기능 2: 검색 하기 ---
        function toggleSearch() {
            document.getElementById('search-header').classList.toggle('active');
            if(document.getElementById('search-header').classList.contains('active')){
                document.getElementById('search-input').focus();
            }
        }

        function handleEnter(e) {
            if (e.key === 'Enter') performSearch();
        }

        async function performSearch() {
            const query = document.getElementById('search-input').value;
            if (!query) return;

            document.getElementById('search-input').blur(); // 키보드 내리기
            VIDEO_LIST.innerHTML = '<div class="loader">검색 중...</div>';

            try {
                // 1. 검색 (ID만 줌)
                const searchRes = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&type=video&maxResults=10&key=${API_KEY}`);
                const searchData = await searchRes.json();
                
                // 2. 비디오 상세 정보 가져오기 (조회수 등을 위해)
                const videoIds = searchData.items.map(item => item.id.videoId).join(',');
                const videoRes = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${videoIds}&key=${API_KEY}`);
                const videoData = await videoRes.json();

                renderVideos(videoData.items);
                
            } catch (e) {
                console.error(e);
                VIDEO_LIST.innerHTML = `<div class="loader">검색 실패 (API 오류)</div>`;
            }
        }

        // --- 공통: 비디오 리스트 렌더링 ---
        function renderVideos(items) {
            if (!items || items.length === 0) {
                VIDEO_LIST.innerHTML = '<div class="loader">검색 결과가 없습니다.</div>';
                return;
            }

            VIDEO_LIST.innerHTML = '';
            
            items.forEach(item => {
                const snippet = item.snippet;
                const stats = item.statistics;
                
                const title = snippet.title;
                const channelTitle = snippet.channelTitle;
                const thumb = snippet.thumbnails.high.url;
                const viewCount = formatCount(stats?.viewCount || 0);
                const timeAgo = formatTime(snippet.publishedAt);
                const vidId = item.id; // video object ID string

                // 카드 HTML 생성
                const card = document.createElement('div');
                card.className = 'video-card';
                card.onclick = () => openPlayer(vidId, title, channelTitle, viewCount, timeAgo, thumb);
                card.innerHTML = `
                    <div class="thumbnail-box">
                        <img src="${thumb}">
                        <div class="time-badge">영상</div>
                    </div>
                    <div class="info-box">
                        <div class="channel-img">
                            <img src="https://ui-avatars.com/api/?name=${channelTitle}&background=random" alt="">
                        </div>
                        <div class="text-area">
                            <div class="v-title">${title}</div>
                            <div class="v-meta">${channelTitle} • 조회수 ${viewCount} • ${timeAgo}</div>
                        </div>
                        <div style="color:#aaa;"><span class="material-symbols-outlined" style="font-size:20px">more_vert</span></div>
                    </div>
                `;
                VIDEO_LIST.appendChild(card);
            });
        }

        // --- 기능 3: 플레이어 열기 & 닫기 ---
        function openPlayer(videoId, title, channel, views, time, thumb) {
            // UI 업데이트
            document.getElementById('wp-title').innerText = title;
            document.getElementById('wp-meta').innerText = `조회수 ${views} • ${time}`;
            document.getElementById('wp-channel-name').innerText = channel;
            document.getElementById('wp-channel-img').src = `https://ui-avatars.com/api/?name=${channel}&background=random`;

            // 플레이어 화면 열기
            WATCH_PAGE.classList.add('open');

            // iframe 삽입 (자동재생)
            PLAYER_CONTAINER.innerHTML = `
                <iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&playsinline=1&rel=0&modestbranding=1" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>`;
        }

        function closePlayer() {
            WATCH_PAGE.classList.remove('open');
            // 영상 정지 (iframe 제거)
            setTimeout(() => {
                PLAYER_CONTAINER.innerHTML = ''; 
            }, 300); // 애니메이션 끝난 후 제거
        }

        // --- 유틸리티: 숫자/날짜 포맷 ---
        function formatCount(num) {
            if (num > 100000000) return (num/100000000).toFixed(1) + '억회';
            if (num > 10000) return Math.floor(num/10000) + '만회';
            if (num > 1000) return (num/1000).toFixed(1) + '천회';
            return num + '회';
        }
        function formatTime(dateStr) {
            const now = new Date();
            const date = new Date(dateStr);
            const diff = (now - date) / 1000; // 초 단위
            if (diff < 60) return '방금 전';
            if (diff < 3600) return Math.floor(diff/60) + '분 전';
            if (diff < 86400) return Math.floor(diff/3600) + '시간 전';
            if (diff < 604800) return Math.floor(diff/86400) + '일 전';
            if (diff < 2592000) return Math.floor(diff/604800) + '주 전';
            return Math.floor(diff/2592000) + '개월 전';
        }

    </script>
</body>
</html>
