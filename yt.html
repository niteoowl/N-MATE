<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTube App</title>
    <!-- Google Fonts (Roboto) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Google Material Symbols (실제 유튜브 앱 아이콘) -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    
    <style>
        /* 1. 기본 설정 (Reset & Variables) */
        :root {
            --bg-color: #0f0f0f;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --nav-height: 48px;
            --bottom-nav-height: 52px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            overflow-x: hidden;
            padding-bottom: var(--bottom-nav-height); /* 하단 바 공간 확보 */
        }

        /* 아이콘 스타일 정의 */
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 24;
            font-size: 24px;
        }
        .filled-icon { font-variation-settings: 'FILL' 1; }

        /* 2. 상단 앱바 (App Bar) */
        header {
            position: sticky;
            top: 0;
            background-color: rgba(15, 15, 15, 0.95);
            backdrop-filter: blur(2px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: var(--nav-height);
            padding: 0 12px;
            z-index: 1000;
        }

        .logo-area { display: flex; align-items: center; gap: 4px; }
        .yt-icon { color: #FF0000; font-size: 28px; }
        .yt-text { font-weight: 700; font-size: 20px; letter-spacing: -0.5px; position: relative; top: -1px;}
        .sup { font-size: 10px; color: var(--text-secondary); margin-left: 2px; position: relative; top: -8px;}

        .top-icons { display: flex; gap: 18px; align-items: center; }
        .top-icons span { cursor: pointer; color: #fff; }

        /* 3. 카테고리 필터 (Chips) */
        .filter-bar {
            position: sticky;
            top: var(--nav-height);
            background-color: var(--bg-color);
            padding: 8px 12px;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            z-index: 900;
            /* 스크롤바 숨기기 */
            -ms-overflow-style: none; scrollbar-width: none;
        }
        .filter-bar::-webkit-scrollbar { display: none; }

        .chip {
            background-color: #272727;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            color: #fff;
            transition: background 0.2s;
            cursor: pointer;
        }
        .chip.active { background-color: #f1f1f1; color: #0f0f0f; }

        /* 4. 비디오 리스트 (App Style) */
        .video-container {
            display: flex;
            flex-direction: column;
            padding-top: 8px;
        }

        .video-card {
            margin-bottom: 24px; /* 카드 간 간격 */
            cursor: pointer;
        }

        .thumbnail-wrapper {
            position: relative;
            width: 100%;
            /* 16:9 비율 유지 */
            aspect-ratio: 16 / 9;
            background-color: #1e1e1e;
        }

        .thumbnail-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .duration-badge {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1px 4px;
            font-size: 12px;
            border-radius: 4px;
            font-weight: 500;
        }

        .video-meta {
            display: flex;
            padding: 12px 12px 0 12px;
            position: relative;
        }

        .channel-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #333;
            margin-right: 12px;
            flex-shrink: 0;
            overflow: hidden;
        }
        .channel-avatar img { width: 100%; height: 100%; object-fit: cover; }

        .text-info { flex: 1; padding-right: 20px; }
        
        .video-title {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.3;
            color: #f1f1f1;
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-details {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .menu-dots {
            position: absolute;
            top: 12px;
            right: 0px;
            padding: 0 8px;
            color: #fff;
        }

        /* 5. 하단 내비게이션 (Bottom Nav) */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--bottom-nav-height);
            background-color: var(--bg-color);
            border-top: 1px solid #282828;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 2000;
            padding-bottom: env(safe-area-inset-bottom); /* 아이폰 하단 바 대응 */
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            height: 100%;
            color: #fff;
            cursor: pointer;
        }

        .nav-item span.material-symbols-outlined {
            font-size: 24px;
            margin-bottom: 2px;
            font-variation-settings: 'wght' 300;
        }
        
        .nav-item.active span.material-symbols-outlined {
            font-variation-settings: 'FILL' 1, 'wght' 400;
        }

        .nav-text { font-size: 10px; }

        /* 업로드 버튼 (+) 특수 처리 */
        .nav-item.upload span {
            font-size: 38px;
            font-weight: 200;
        }

        /* 로딩 스피너 */
        .loader {
            display: flex;
            justify-content: center;
            padding: 20px;
            color: #aaa;
        }
    </style>
</head>
<body>

    <!-- 헤더 -->
    <header>
        <div class="logo-area">
            <span class="material-symbols-outlined filled-icon yt-icon" style="color:#ff0000; font-size:30px;">play_arrow</span>
            <span class="yt-text">YouTube</span><span class="sup">KR</span>
        </div>
        <div class="top-icons">
            <span class="material-symbols-outlined">cast</span>
            <span class="material-symbols-outlined">notifications</span>
            <span class="material-symbols-outlined">search</span>
        </div>
    </header>

    <!-- 필터 바 -->
    <div class="filter-bar">
        <div class="chip active">전체</div>
        <div class="chip">게임</div>
        <div class="chip">뉴스</div>
        <div class="chip">음악</div>
        <div class="chip">라이브</div>
        <div class="chip">요리</div>
        <div class="chip">최근에 업로드된 동영상</div>
    </div>

    <!-- 비디오 컨테이너 -->
    <main class="video-container" id="videoList">
        <!-- 자바스크립트로 비디오 카드가 여기에 채워집니다 -->
        <div class="loader">
            <span class="material-symbols-outlined" style="animation: spin 1s linear infinite;">progress_activity</span>
        </div>
    </main>

    <!-- 하단 내비게이션 -->
    <nav class="bottom-nav">
        <div class="nav-item active">
            <span class="material-symbols-outlined">home</span>
            <span class="nav-text">홈</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">slow_motion_video</span>
            <span class="nav-text">Shorts</span>
        </div>
        <div class="nav-item upload">
            <span class="material-symbols-outlined">add_circle</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">subscriptions</span>
            <span class="nav-text">구독</span>
        </div>
        <div class="nav-item">
            <span class="material-symbols-outlined">account_circle</span>
            <span class="nav-text">나</span>
        </div>
    </nav>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        const API_KEY = 'AIzaSyD9gpmEbUyP9h9Rm3nayK7PLYek5Ja7B38'; // 사용자 제공 키
        const MAX_RESULTS = 10;
        
        // ==========================================
        // HELPERS (데이터 포맷팅)
        // ==========================================
        
        // 숫자 포맷 (예: 120000 -> 12만회)
        function formatViews(views) {
            if (views >= 100000000) return (views / 100000000).toFixed(1) + '억회';
            if (views >= 10000) return (Math.floor(views / 10000)) + '만회';
            if (views >= 1000) return (views / 1000).toFixed(1) + '천회';
            return views + '회';
        }

        // 시간 포맷 (예: PT1H2M10S -> 1:02:10)
        function parseDuration(duration) {
            const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
            const hours = (match[1] || '').replace('H', '');
            const minutes = (match[2] || '').replace('M', '');
            const seconds = (match[3] || '').replace('S', '');

            let result = '';
            if (hours) result += hours + ':';
            result += (hours && minutes.length === 1 ? '0' : '') + (minutes || '0') + ':';
            result += (seconds.length === 1 ? '0' : '') + (seconds || '00');
            return result;
        }

        // 날짜 차이 (예: 2일 전)
        function timeAgo(dateString) {
            const now = new Date();
            const past = new Date(dateString);
            const diffMs = now - past;
            const diffHours = diffMs / (1000 * 60 * 60);

            if (diffHours < 1) return '방금 전';
            if (diffHours < 24) return Math.floor(diffHours) + '시간 전';
            if (diffHours < 24 * 7) return Math.floor(diffHours / 24) + '일 전';
            if (diffHours < 24 * 30) return Math.floor(diffHours / (24 * 7)) + '주 전';
            if (diffHours < 24 * 365) return Math.floor(diffHours / (24 * 30)) + '개월 전';
            return Math.floor(diffHours / (24 * 365)) + '년 전';
        }

        // ==========================================
        // API FETCHING
        // ==========================================

        async function fetchYouTubeData() {
            const container = document.getElementById('videoList');
            
            try {
                // 1. 인기 동영상 목록 가져오기
                const videoUrl = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics,contentDetails&chart=mostPopular&regionCode=KR&maxResults=${MAX_RESULTS}&key=${API_KEY}`;
                const videoResponse = await fetch(videoUrl);
                const videoData = await videoResponse.json();

                if (!videoData.items) {
                    throw new Error("API Limit Exceeded or Error");
                }

                // 2. 채널 ID 수집 (프로필 사진을 위해)
                const channelIds = videoData.items.map(item => item.snippet.channelId).join(',');
                
                // 3. 채널 정보 가져오기 (배치 요청)
                const channelUrl = `https://www.googleapis.com/youtube/v3/channels?part=snippet&id=${channelIds}&key=${API_KEY}`;
                const channelResponse = await fetch(channelUrl);
                const channelData = await channelResponse.json();

                // 채널 ID로 맵핑 생성
                const channelMap = {};
                channelData.items.forEach(ch => {
                    channelMap[ch.id] = ch.snippet.thumbnails.default.url;
                });

                // 4. UI 렌더링
                container.innerHTML = ''; // 로더 제거

                videoData.items.forEach(video => {
                    const snippet = video.snippet;
                    const stats = video.statistics;
                    const content = video.contentDetails;

                    // 데이터 가공
                    const thumbnail = snippet.thumbnails.maxres ? snippet.thumbnails.maxres.url : snippet.thumbnails.high.url;
                    const avatar = channelMap[snippet.channelId] || 'https://via.placeholder.com/36';
                    const duration = parseDuration(content.duration);
                    const viewCount = formatViews(stats.viewCount);
                    const publishedTime = timeAgo(snippet.publishedAt);

                    // HTML 템플릿
                    const card = document.createElement('div');
                    card.className = 'video-card';
                    card.innerHTML = `
                        <div class="thumbnail-wrapper">
                            <img src="${thumbnail}" alt="썸네일">
                            <div class="duration-badge">${duration}</div>
                        </div>
                        <div class="video-meta">
                            <div class="channel-avatar">
                                <img src="${avatar}" alt="채널">
                            </div>
                            <div class="text-info">
                                <div class="video-title">${snippet.title}</div>
                                <div class="video-details">
                                    ${snippet.channelTitle} • 조회수 ${viewCount} • ${publishedTime}
                                </div>
                            </div>
                            <div class="menu-dots">
                                <span class="material-symbols-outlined" style="font-size:20px;">more_vert</span>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });

            } catch (error) {
                console.error(error);
                container.innerHTML = `<div style="text-align:center; padding:20px; color:#aaa;">
                    데이터를 불러올 수 없습니다.<br>API 키 할당량이 초과되었거나 오류가 발생했습니다.
                </div>`;
            }
        }

        // 실행
        fetchYouTubeData();

    </script>
    <style>
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</body>
</html>
