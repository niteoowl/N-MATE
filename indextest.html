<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>í•™êµìƒí™œ ì •ë³´ ì•±</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
<style>
:root{
  /* ë‹¤í¬ëª¨ë“œ í…Œë§ˆ (í† ìŠ¤ ì•± ëŠë‚Œ) */
  --brand:#6A5AF8;
  --brand-600:#5748D8;
  --brand-50:#2E265C;

  --bg:#121212;
  --surface:#1F1F1F;
  --text:#FFFFFF;
  --muted:#A9A9A9;
  --hairline:#333333;

  --radius:16px;
  --radius-sm:12px;

  --app-max:1024px;
  --app-pad:16px;
  --bar-h:56px;
  --tab-h:64px;
}

/* ë¼ì´íŠ¸ëª¨ë“œ í…Œë§ˆ (ë‹¤í¬ëª¨ë“œ ë³€ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ) */
body.light-mode {
  --bg:#F5F7FA;
  --surface:#FFFFFF;
  --text:#0F172A;
  --muted:#667085;
  --hairline:#E5E7EB;

  /* ë¼ì´íŠ¸ëª¨ë“œì—ì„œ ì¼ë¶€ ìš”ì†Œ ìƒ‰ìƒ ì¬ì •ì˜ */
  --brand:#4A90E2;
  --brand-600:#3A7ACF;
  --brand-50:#EAF2FF;
}

/* ì „ì²´ í™”ë©´ì— ì¤‘ì•™ ì•± ìº”ë²„ìŠ¤(íƒœë¸”ë¦¿) ê³ ì • */
html,body{height:100%; margin:0}
body{
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Pretendard","Malgun Gothic",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.app-wrap{
  height:100dvh;
  display:grid; place-items:center;
  padding:calc(env(safe-area-inset-top,0px)) 0 calc(env(safe-area-inset-bottom,0px));
}
.shell{
  width:clamp(360px, 78vw, var(--app-max));
  height:100dvh;
  display:grid; grid-template-rows:var(--bar-h) 1fr var(--tab-h);
  background:var(--surface);
  border-left:1px solid var(--hairline);
  border-right:1px solid var(--hairline);
}

/* ìƒë‹¨ ì•±ë°” */
.appbar{
  display:flex; align-items:center; justify-content:space-between;
  padding:0 14px;
  border-bottom:1px solid var(--hairline);
  background:var(--surface);
  position: relative;
}
.appbar .title{font-weight:800; letter-spacing:-0.2px}
.appbar .actions{display:flex; gap:8px}

/* ëª¨ë“  ë²„íŠ¼ì— í´ë¦­ íš¨ê³¼ ì ìš© */
.btn, .chip, .icon-btn, .quick-item, .fab, .card-link {
    transition: transform 0.1s ease-in-out;
}
.btn:active, .chip:active, .icon-btn:active, .quick-item:active, .fab:active, .card-link:active {
    transform: scale(0.98);
}

.btn, .chip{
  border:1px solid var(--hairline); background:var(--surface); color:var(--text);
  height:34px; padding:0 12px; border-radius:12px; font-weight:700; cursor:pointer;
}
.icon-btn{
  width:34px; height:34px; border:1px solid var(--hairline); border-radius:12px; background:var(--surface); color:var(--text); cursor:pointer;
  display: grid;
  place-items: center;
}
.material-symbols-outlined {
    font-size: 20px;
    font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 24
}
.icon-btn .moon-icon {
    display: none;
}
body.light-mode .icon-btn .sun-icon {
    display: none;
}
body.light-mode .icon-btn .moon-icon {
    display: block;
}
/* ë¼ì´íŠ¸ ëª¨ë“œì—ì„œ ì•„ì´ì½˜ ìƒ‰ìƒ ë³€ê²½ */
body.light-mode .material-symbols-outlined {
    color: var(--text);
}


/* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ: ìŠ¤í¬ë¡¤ ë°©ì§€ */
.page-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
}
.page{
  display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ìˆ¨ê¹€ */
  width: 100%;
  height: 100%;
  overflow-y: auto; /* ê°œë³„ í˜ì´ì§€ ìŠ¤í¬ë¡¤ í—ˆìš© */
  padding:var(--app-pad) var(--app-pad) calc(var(--app-pad) + 24px);
  box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„/ë†’ì´ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
}
.page.active {
    display: block; /* í™œì„±í™”ëœ í˜ì´ì§€ë¥¼ í‘œì‹œ */
}

.section-title{margin:6px 2px 10px; font-weight:800; font-size:15px}
.sub{font-size:12px; color:var(--muted)}
.card-title-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.hidden{display: none;}

/* ì¹´ë“œ/ë¼ì¸: ê·¸ë¦¼ì ì—†ìŒ */
.card{
  background:var(--surface); border:1px solid var(--hairline);
  border-radius:var(--radius); padding:16px;
}
.card-link {
    display: block;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    transition: background-color 0.1s ease-in-out;
}
.card-link:hover {
    background-color: var(--hairline);
}

/* ë¦¬ìŠ¤íŠ¸ */
.list{margin-top:10px; border:1px solid var(--hairline); border-radius:14px; overflow:hidden}
.cell{display:flex; align-items:center; gap:12px; padding:14px 16px; border-bottom:1px solid var(--hairline); background:var(--surface)}
.cell:last-child{border-bottom:none}
.avatar{width:40px; height:40px; border-radius:12px; background:var(--brand-50); color:var(--brand); display:grid; place-items:center; font-weight:800}
.cell .meta{flex:1}
.title{font-weight:700}
.amount{font-weight:800}
.positive{color:#16A34A}
.negative{color:#DC2626}

/* FAB + íƒ­ë°”: ì•± íŒ¨í„´ ìœ ì§€ */
.fab{
  position:fixed;
  left:50%;
  transform:translateX(calc(-50% + min(39vw, var(--app-max)/2 - 24px)));
  bottom:calc(var(--tab-h) + 18px);
  width:56px; height:56px; border-radius:16px;
  background:var(--brand); color:#fff; display:grid; place-items:center; font-weight:800; border:0;
}
.tabbar{
  border-top:1px solid var(--hairline);
  background:rgba(31,31,31,0.96); backdrop-filter:saturate(180%) blur(8px);
}
body.light-mode .tabbar {
  background:rgba(255,255,255,0.96);
}

.tabs{height:var(--tab-h); display:grid; grid-template-columns:repeat(4,1fr)}
.tab{
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
  color:var(--muted); font-size:12px; border:0; background:transparent; cursor:pointer;
}
.tab .dot{width:6px; height:6px; border-radius:50%; background:transparent}
.tab.active{color:var(--brand)}
.tab.active .dot{background:var(--brand)}

/* ë§í¬/í¬ì»¤ìŠ¤ */
a, button{color:inherit}
:focus-visible{outline:2px solid var(--brand); outline-offset:2px; border-radius:10px}

/* ë°˜ì‘í˜•: í°ì—ì„œëŠ” 2ì—´ ê·¸ë¦¬ë“œ, íƒœë¸”ë¦¿ì€ 4ì—´ ìœ ì§€ */
@media (max-width: 560px){
  .quick-grid{grid-template-columns:repeat(2,1fr)}
}
/* ë„“ì€ ë°ìŠ¤í¬í†±ì—ì„œë„ â€˜ì•± í•œ ì¥â€™ ëŠë‚Œ ìœ ì§€ */
@media (min-width: 1400px){
  .shell{width:clamp(360px, 56vw, var(--app-max))}
}

/* iOS í™ˆ ì¸ë””ì¼€ì´í„° ì—¬ë°± */
.tabbar{padding-bottom:calc(env(safe-area-inset-bottom, 0px) + 0px);}

/* í•™êµìƒí™œ ì„œë¸Œ íƒ­ */
.school-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}
.school-tabs .chip {
    flex: 1;
    border: 1px solid var(--hairline);
    background: var(--surface);
    color: var(--muted);
    height: 40px;
    padding: 0 16px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    display: grid;
    place-items: center;
}
.school-tabs .chip.active {
    background: var(--brand-50);
    color: var(--brand);
    border-color: var(--brand-50);
}

/* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
.modal-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(0, 0, 0, 0.4);
    display: none;
    z-index: 10;
}
.modal-overlay.open {
    display: block;
}
.modal-content {
    position: absolute;
    bottom: 0; left: 0;
    width: 100%;
    max-height: 80%; /* ëª¨ë‹¬ ìµœëŒ€ ë†’ì´ ì„¤ì • */
    overflow-y: auto; /* ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
    background: var(--surface);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    padding: 16px;
    transform: translateY(100%);
    transition: transform 0.3s ease-in-out;
    box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„/ë†’ì´ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
}
.modal-content.is-open {
    transform: translateY(0);
}
.modal-close-handle {
    width: 40px;
    height: 4px;
    background-color: var(--muted);
    border-radius: 2px;
    margin: 0 auto 16px;
    cursor: pointer;
}

/* ë‹¬ë ¥ ìŠ¤íƒ€ì¼ */
.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}
.calendar-header .month-year {
    font-size: 18px;
    font-weight: 700;
}
.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    gap: 8px;
}
.calendar-grid .day {
    padding: 8px;
    font-weight: 500;
    border-radius: 50%;
    cursor: pointer;
}
.calendar-grid .day.today {
    background: var(--brand);
    color: white;
}
.calendar-grid .weekday {
    font-weight: 700;
    color: var(--muted);
}

/* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
body::-webkit-scrollbar,
.page::-webkit-scrollbar,
.modal-content::-webkit-scrollbar {
    width: 6px;
}

body::-webkit-scrollbar-thumb,
.page::-webkit-scrollbar-thumb,
.modal-content::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
}

body.light-mode::-webkit-scrollbar-thumb,
.page.light-mode::-webkit-scrollbar-thumb,
.modal-content.light-mode::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.2);
}

body::-webkit-scrollbar-track,
.page::-webkit-scrollbar-track,
.modal-content::-webkit-scrollbar-track {
    background: transparent;
}

/* ì»¤ë®¤ë‹ˆí‹° ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
.community-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin-top: 10px;
}

.community-item {
  border: 1px solid var(--hairline);
  background: var(--surface);
  border-radius: var(--radius);
  padding: 14px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.community-item .category {
    font-size: 12px;
    color: var(--brand);
}

.community-item .post-title {
    font-weight: 700;
    font-size: 15px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    word-break: break-word;
}

.community-item .preview {
    font-size: 13px;
    line-height: 1.4;
    color: var(--muted);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    word-break: break-word;
}

.community-item .meta {
    font-size: 12px;
    color: var(--muted);
    margin-top: auto;
}

/* ë¡œê·¸ì¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸° */
#loginBtn.hidden { display: none; }
#userProfileBtn {
  font-weight:700;
  background:transparent;
  border:none;
  cursor:pointer;
  position: relative;
  height: 34px;
  padding: 0 12px;
  border-radius: 12px;
}
#userProfileBtn:hover { background-color: var(--hairline); }

/* ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
#profileDropdown {
  position: absolute;
  top: 50px;
  right: 14px;
  background: var(--surface);
  border: 1px solid var(--hairline);
  border-radius: 8px;
  padding: 8px;
  z-index: 20;
  width: 150px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  display: none;
}
#profileDropdown.show { display: block; }
.dropdown-item {
  padding: 10px;
  cursor: pointer;
  border-radius: 6px;
}
.dropdown-item:hover { background-color: var(--hairline); }
</style>
</head>
<body>
  <div class="app-wrap">
    <div class="shell" aria-label="ì•± ìº”ë²„ìŠ¤">

      <!-- ì•±ë°” -->
      <header class="appbar">
        <div class="title" id="appTitle">í™ˆ</div>
        <div class="actions">
          <button class="btn" id="loginBtn">ë¡œê·¸ì¸</button>
          <button id="userProfileBtn" class="hidden">
            <span id="userNameText"></span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <!-- ë“œë¡­ë‹¤ìš´ ë©”ë‰´ -->
          <div id="profileDropdown" class="hidden">
            <div class="dropdown-item" id="editProfileBtn">í”„ë¡œí•„ í¸ì§‘</div>
            <div class="dropdown-item" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</div>
          </div>
          <button class="icon-btn" id="modeToggleBtn" aria-label="ë¼ì´íŠ¸ëª¨ë“œ/ë‹¤í¬ëª¨ë“œ í† ê¸€">
            <span class="material-symbols-outlined sun-icon">light_mode</span>
            <span class="material-symbols-outlined moon-icon">dark_mode</span>
          </button>
        </div>
      </header>
      
      <!-- í˜ì´ì§€ ì»¨í…Œì´ë„ˆ -->
      <div class="page-container" id="pageContainer">
        <!-- í˜ì´ì§€: í™ˆ -->
        <main class="page active" id="page-home" role="region" aria-label="í™ˆ">
          <section class="card">
            <div class="card-title-row">
                <div class="section-title">ì˜¤ëŠ˜ì˜ í•™êµìƒí™œ</div>
                <button id="today-info-btn" class="icon-btn" aria-label="ì˜¤ëŠ˜ì˜ í•™êµìƒí™œ ì •ë³´ ë”ë³´ê¸°">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
            </div>
            <div class="sub">ì˜¤ëŠ˜ì˜ ê¸‰ì‹ê³¼ ì‹œê°„í‘œë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>
            <div style="margin-top:10px; display:grid; gap:10px; grid-template-columns:repeat(2,1fr)">
              <div class="card" style="padding:12px">
                <div class="title">ì ì‹¬ ê¸‰ì‹</div>
                <div class="sub" style="margin-top:4px" id="todayLunchMenu">ë¡œë”© ì¤‘...</div>
              </div>
              <div class="card card-link timetable-quick-card" style="padding:12px">
                <div class="title">ì´ <span id="timetablePeriodCount">...</span>êµì‹œ</div>
                <div class="sub" style="margin-top:4px">ìì„¸í•œ ì‹œê°„í‘œ ë³´ê¸°</div>
              </div>
            </div>
          </section>

          <div class="card-title-row">
              <h3 class="section-title">ì»¤ë®¤ë‹ˆí‹° ìƒˆ ì†Œì‹ ğŸ”¥</h3>
              <button class="btn" style="height:28px">ë”ë³´ê¸°</button>
          </div>
          <div class="community-grid" role="region" aria-label="ì»¤ë®¤ë‹ˆí‹° ìµœì‹  ê¸€">
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ë´‰ì‚¬í™œë™ ì‹ ì²­ ì•ˆë‚´</div>
                  <div class="preview">ì´ë²ˆ í•™ê¸° ë´‰ì‚¬í™œë™ ì‹ ì²­ì„ 6ì›” 25ì¼ê¹Œì§€ ë°›ìŠµë‹ˆë‹¤. ì‹ ì²­ì„œ ì–‘ì‹ì€ í•™ìƒíšŒê´€ 2ì¸µ ê²Œì‹œíŒì—ì„œ í™•ì¸í•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì´ì¢…í˜„ Â· 4ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">í•™êµ ì¶•ì œ ì•„ì´ë””ì–´ ê³µëª¨</div>
                  <div class="preview">ë‹¤ê°€ì˜¤ëŠ” ê°€ì„ ì¶•ì œ 'í•˜ë‚˜ ë˜ëŠ” ìš°ë¦¬'ì˜ ì•„ì´ë””ì–´ë¥¼ ê³µëª¨í•©ë‹ˆë‹¤! ê³µì—°, ë¶€ìŠ¤, ì´ë²¤íŠ¸ ë“± ììœ ë¡­ê²Œ ì œì•ˆí•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì½”ì½”ëª½ Â· 9ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ê¸°ìˆ™ì‚¬ìƒ ì™¸ë°• ì‹ ì²­ ì•ˆë‚´</div>
                  <div class="preview">ì—¬ë¦„ë°©í•™ ê¸°ê°„ ë™ì•ˆ ê¸°ìˆ™ì‚¬ ì™¸ë°•ì„ í¬ë§í•˜ëŠ” í•™ìƒë“¤ì€ 7ì›” 5ì¼ê¹Œì§€ ì‹ ì²­í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</div>
                  <div class="meta">ì˜¤ë Œì§€ Â· 13ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ì²´ìœ¡ëŒ€íšŒ ì¢…ëª© íˆ¬í‘œ</div>
                  <div class="preview">ì˜¬í•´ ì²´ìœ¡ëŒ€íšŒì—ì„œ ì§„í–‰í•  ì¢…ëª©ì„ íˆ¬í‘œë¡œ ê²°ì •í•©ë‹ˆë‹¤. ë†êµ¬, í”¼êµ¬, ì´ì–´ë‹¬ë¦¬ê¸° ë“± ì„ í˜¸í•˜ëŠ” ì¢…ëª©ì— íˆ¬í‘œí•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì²´ìœ¡ë¶€ Â· 18ì¼ ì „</div>
              </div>
          </div>

          <h3 class="section-title">ë‹¤ê°€ì˜¤ëŠ” í•™ì‚¬ì¼ì •</h3>
          <div class="list" role="list" id="schoolScheduleList">
            <div class="cell" role="listitem">
              <div class="avatar">ë¡œ</div>
              <div class="meta">
                <div class="title">í•™ì‚¬ì¼ì • ë¡œë”© ì¤‘...</div>
                <div class="sub">ì‚¬ìš©ì í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.</div>
              </div>
            </div>
          </div>
        </main>

        <!-- í˜ì´ì§€: í•™êµìƒí™œ -->
        <main class="page" id="page-school" role="region" aria-label="í•™êµìƒí™œ">
          <div class="school-tabs">
            <button class="chip active" data-target="meal">ê¸‰ì‹</button>
            <button class="chip" data-target="timetable">ì‹œê°„í‘œ</button>
            <button class="chip" data-target="schedule">í•™ì‚¬ì¼ì •</button>
          </div>
          
          <div id="content-meal">
              <section class="card">
                  <div class="section-title">ê¸‰ì‹</div>
                  <div class="sub">ì˜¤ëŠ˜ì˜ ì ì‹¬ ë©”ë‰´</div>
                  <div style="margin-top:10px;">
                      <div class="list">
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">ì ì‹¬</div>
                                  <div class="sub" id="schoolMealMenu">ë¡œë”© ì¤‘...</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>

          <!-- initially hidden -->
          <div id="content-timetable" class="hidden">
              <section class="card">
                  <div class="section-title">ì‹œê°„í‘œ</div>
                  <div class="sub">ì˜¤ëŠ˜ì˜ ìˆ˜ì—… ì‹œê°„í‘œ</div>
                  <div style="margin-top:10px;">
                      <div class="list" id="schoolTimetableList">
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">ë¡œë”© ì¤‘...</div>
                                  <div class="sub">ì‚¬ìš©ì í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>

          <!-- initially hidden -->
          <div id="content-schedule" class="hidden">
              <section class="card">
                  <div class="section-title">í•™ì‚¬ì¼ì •</div>
                  <div class="sub">ë‹¤ê°€ì˜¤ëŠ” ì£¼ìš” ì¼ì •</div>
                  <div style="margin-top:10px;">
                      <div class="list" id="schoolScheduleFullList">
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">ë¡œë”© ì¤‘...</div>
                                  <div class="sub">ì‚¬ìš©ì í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>
        </main>

        <!-- í˜ì´ì§€: ì»¤ë®¤ë‹ˆí‹° -->
        <main class="page" id="page-community" role="region" aria-label="ì»¤ë®¤ë‹ˆí‹°">
          <section class="card">
            <div class="section-title">ì»¤ë®¤ë‹ˆí‹°</div>
            <div class="sub">ììœ  ê²Œì‹œíŒ, ë™ì•„ë¦¬</div>
            <div style="margin-top:10px; border:1px dashed var(--hairline); border-radius:12px; padding:16px; text-align:center;">
              <p style="color:var(--muted)">ë‹¤ì–‘í•œ ì†Œì‹ì„ ê³µìœ í•´ë³´ì„¸ìš”!</p>
              <button class="chip" style="margin-top:12px; background:var(--brand); color:white; border-color:var(--brand);">ê¸€ì“°ê¸°</button>
            </div>
          </section>
        </main>

        <!-- í˜ì´ì§€: ë”ë³´ê¸° -->
        <main class="page" id="page-more" role="region" aria-label="ë”ë³´ê¸°">
          <section class="card">
            <div class="section-title">ë”ë³´ê¸°</div>
            <div class="sub">ì„¤ì •, ì •ë³´, ê³ ê°ì„¼í„°</div>
            <div style="margin-top:10px; display:grid; grid-template-columns:repeat(3,1fr); gap:10px">
              <button class="quick-item"><div class="quick-ico">ì„¤</div><div>ì„¤ì •</div></button>
              <button class="quick-item"><div class="quick-ico">ê³µ</div><div>ê³µì§€ì‚¬í•­</div></button>
              <button class="quick-item"><div class="quick-ico">ë„</div><div>ë„ì›€ë§</div></button>
            </div>
          </section>
        </main>
      </div>

      <!-- í•˜ë‹¨ íƒ­ë°” -->
      <nav class="tabbar" role="tablist" aria-label="í•˜ë‹¨ ë‚´ë¹„ê²Œì´ì…˜">
        <div class="tabs">
          <button class="tab active" data-target="home" role="tab" aria-selected="true">í™ˆ<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="school" role="tab" aria-selected="false">í•™êµìƒí™œ<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="community" role="tab" aria-selected="false">ì»¤ë®¤ë‹ˆí‹°<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="more" role="tab" aria-selected="false">ë”ë³´ê¸°<span class="dot" aria-hidden="true"></span></button>
        </div>
      </nav>

      <!-- FAB -->
      <button class="fab" aria-label="ìƒˆ ê¸€ì“°ê¸°">ï¼‹</button>
    </div>
  </div>

  <!-- ë‹¬ë ¥ ëª¨ë‹¬ -->
  <div class="modal-overlay" id="calendarModal">
    <div class="modal-content">
        <div class="modal-close-handle" id="modalCloseHandle"></div>
        <div class="calendar-header">
            <button class="icon-btn prev-month">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7z"/></svg>
            </button>
            <span class="month-year">2025ë…„ 9ì›”</span>
            <button class="icon-btn next-month">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M10 6l-6 6 6 6z" transform="rotate(180 12 12)"/></svg>
            </button>
        </div>
        <div class="calendar-grid">
            <span class="weekday" style="color:#DC2626">ì¼</span>
            <span class="weekday">ì›”</span>
            <span class="weekday">í™”</span>
            <span class="weekday">ìˆ˜</span>
            <span class="weekday">ëª©</span>
            <span class="weekday">ê¸ˆ</span>
            <span class="weekday" style="color:#4A90E2">í† </span>
            <span class="day muted">31</span>
            <span class="day">1</span>
            <span class="day">2</span>
            <span class="day">3</span>
            <span class="day">4</span>
            <span class="day">5</span>
            <span class="day">6</span>
            <span class="day">7</span>
            <span class="day">8</span>
            <span class="day">9</span>
            <span class="day">10</span>
            <span class="day">11</span>
            <span class="day">12</span>
            <span class="day">13</span>
            <span class="day">14</span>
            <span class="day">15</span>
            <span class="day">16</span>
            <span class="day">17</span>
            <span class="day">18</span>
            <span class="day">19</span>
            <span class="day">20</span>
            <span class="day">21</span>
            <span class="day">22</span>
            <span class="day">23</span>
            <span class="day">24</span>
            <span class="day">25</span>
            <span class="day">26</span>
            <span class="day">27</span>
            <span class="day">28</span>
            <span class="day">29</span>
            <span class="day">30</span>
        </div>
    </div>
  </div>

<script type="module">
  // Firebase SDK imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  // Firestore & Auth ì „ì—­ ë³€ìˆ˜
  let app, auth, db;
  let userId;
  let userProfile = null;

  // Firebase ì„¤ì • ë° ì´ˆê¸°í™”
  const firebaseConfig = {
    apiKey: "AIzaSyC_SHRcQ9hXmjVbP3km4rdR4UvKIoqpLHo",
    authDomain: "n-mate.firebaseapp.com",
    projectId: "n-mate",
    storageBucket: "n-mate.firebasestorage.app",
    messagingSenderId: "691313471077",
    appId: "1:691313471077:web:3066aaeca0a1d9e448e08c",
    measurementId: "G-0LCGVBKXLQ"
  };

  const __app_id = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

  // API í‚¤ì™€ ì—”ë“œí¬ì¸íŠ¸
  const neisApiKey = "cbb4da48e87445f68c2732368454ebc3";
  const neisApiUrl = "https://open.neis.go.kr/hub/";

  // UI ìš”ì†Œ
  const loginBtn = document.getElementById('loginBtn');
  const userProfileBtn = document.getElementById('userProfileBtn');
  const userNameText = document.getElementById('userNameText');
  const profileDropdown = document.getElementById('profileDropdown');
  const editProfileBtn = document.getElementById('editProfileBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const todayLunchMenu = document.getElementById('todayLunchMenu');
  const timetablePeriodCount = document.getElementById('timetablePeriodCount');
  const schoolMealMenu = document.getElementById('schoolMealMenu');
  const schoolTimetableList = document.getElementById('schoolTimetableList');
  const schoolScheduleFullList = document.getElementById('schoolScheduleFullList');
  const schoolScheduleList = document.getElementById('schoolScheduleList');

  // Firebase ì´ˆê¸°í™”
  const initializeFirebase = async () => {
    try {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      db = getFirestore(app);

      // ì‚¬ìš©ì ì¸ì¦ ìƒíƒœ ë³€í™” ê°ì§€
      onAuthStateChanged(auth, async (user) => {
        if (user) {
          userId = user.uid;
          // Firestoreì—ì„œ í”„ë¡œí•„ ë¬¸ì„œ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
          const userProfileRef = doc(db, `artifacts/${__app_id}/users/${userId}/profile/user_data`);
          onSnapshot(userProfileRef, (docSnap) => {
            if (docSnap.exists()) {
              userProfile = docSnap.data();
              console.log("í”„ë¡œí•„ ë¡œë“œ ì™„ë£Œ:", userProfile);
              updateUIForLoggedInUser(userProfile);
            } else {
              console.log("í”„ë¡œí•„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
              updateUIForLoggedInUser(null);
            }
          });
        } else {
          // ë¡œê·¸ì•„ì›ƒ ìƒíƒœì¼ ë•Œ UI ì—…ë°ì´íŠ¸
          updateUIForLoggedOutUser();
        }
      });

      // ìš”ì²­ì— ë”°ë¼ ìµëª… ë¡œê·¸ì¸ ëŒ€ì‹  ì»¤ìŠ¤í…€ í† í° ë¡œê·¸ì¸ë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
      if (typeof __initial_auth_token !== 'undefined') {
        await signInWithCustomToken(auth, __initial_auth_token);
      } else {
        console.error("ì»¤ìŠ¤í…€ ì¸ì¦ í† í°ì´ ì—†ì–´ ë¡œê·¸ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }

    } catch (error) {
      console.error("Firebase ì´ˆê¸°í™” ë˜ëŠ” ë¡œê·¸ì¸ ì‹¤íŒ¨:", error);
    }
  };

  // ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ UI ì—…ë°ì´íŠ¸
  const updateUIForLoggedInUser = (profile) => {
    loginBtn.classList.add('hidden');
    userProfileBtn.classList.remove('hidden');
    userNameText.textContent = profile?.name ? `${profile.name}ë‹˜` : 'ì‚¬ìš©ì';
    
    // ë‚˜ì´ìŠ¤ API ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    if (profile) {
      fetchNeisData(profile);
    }
  };
  
  // ë¡œê·¸ì•„ì›ƒ ìƒíƒœì¼ ë•Œ UI ì—…ë°ì´íŠ¸
  const updateUIForLoggedOutUser = () => {
    loginBtn.classList.remove('hidden');
    userProfileBtn.classList.add('hidden');
    // ë°ì´í„° ì´ˆê¸°í™”
    todayLunchMenu.textContent = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.';
    timetablePeriodCount.textContent = '...';
    schoolMealMenu.textContent = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.';
    schoolTimetableList.innerHTML = `<div class="cell"><div class="meta"><div class="title">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</div><div class="sub">í”„ë¡œí•„ì„ ì„¤ì •í•˜ë©´ ì‹œê°„í‘œë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”.</div></div></div>`;
    schoolScheduleFullList.innerHTML = `<div class="cell"><div class="meta"><div class="title">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</div><div class="sub">í”„ë¡œí•„ì„ ì„¤ì •í•˜ë©´ í•™ì‚¬ì¼ì •ì„ ë³¼ ìˆ˜ ìˆì–´ìš”.</div></div></div>`;
    schoolScheduleList.innerHTML = `<div class="cell"><div class="meta"><div class="title">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</div><div class="sub">í”„ë¡œí•„ì„ ì„¤ì •í•˜ë©´ í•™ì‚¬ì¼ì •ì„ ë³¼ ìˆ˜ ìˆì–´ìš”.</div></div></div>`;
  };

  // ë‚˜ì´ìŠ¤ APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  const fetchNeisData = async (profile) => {
    if (!profile.sdSchulCode || !profile.atptOfcdcScCode || !profile.grade || !profile.classNum) {
      console.error("ë‚˜ì´ìŠ¤ APIë¥¼ í˜¸ì¶œí•  í”„ë¡œí•„ ì •ë³´ê°€ ë¶ˆì™„ì „í•©ë‹ˆë‹¤.");
      return;
    }

    const today = new Date();
    const YMD = `${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}${String(today.getDate()).padStart(2, '0')}`;
    const YM = `${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}`;
    const apiBase = `${neisApiUrl}`;
    
    const fetchData = async (endpoint, params) => {
      const url = new URL(apiBase + endpoint);
      url.searchParams.append('KEY', neisApiKey);
      url.searchParams.append('Type', 'json');
      url.searchParams.append('pIndex', 1);
      url.searchParams.append('pSize', 100);
      Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
      
      try {
        const response = await fetch(url.toString());
        const data = await response.json();
        return data;
      } catch (error) {
        console.error("ë‚˜ì´ìŠ¤ API í˜¸ì¶œ ì‹¤íŒ¨:", error);
        return null;
      }
    };
    
    // ê¸‰ì‹ ì •ë³´ ë¡œë“œ
    const mealParams = {
      ATPT_OFCDC_SC_CODE: profile.atptOfcdcScCode,
      SD_SCHUL_CODE: profile.sdSchulCode,
      MLSV_YMD: YMD
    };
    const mealData = await fetchData('mealServiceDietInfo', mealParams);
    if (mealData && mealData.mealServiceDietInfo && mealData.mealServiceDietInfo[1].row.length > 0) {
      const lunch = mealData.mealServiceDietInfo[1].row.find(item => item.MMEAL_SC_NM === 'ì¤‘ì‹');
      if (lunch) {
        const menu = lunch.DDISH_NM.replace(/<br\/>/g, ', ').replace(/\s*\(\d+\.\d+\)\s*/g, '').trim();
        todayLunchMenu.textContent = menu;
        schoolMealMenu.textContent = menu;
      } else {
        todayLunchMenu.textContent = 'ì˜¤ëŠ˜ì˜ ì ì‹¬ ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
        schoolMealMenu.textContent = 'ì˜¤ëŠ˜ì˜ ì ì‹¬ ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
      }
    } else {
        todayLunchMenu.textContent = 'ê¸‰ì‹ ì •ë³´ ì—†ìŒ';
        schoolMealMenu.textContent = 'ê¸‰ì‹ ì •ë³´ ì—†ìŒ';
    }

    // ì‹œê°„í‘œ ì •ë³´ ë¡œë“œ
    const timetableParams = {
      ATPT_OFCDC_SC_CODE: profile.atptOfcdcScCode,
      SD_SCHUL_CODE: profile.sdSchulCode,
      AY: new Date().getFullYear(),
      GRADE: profile.grade,
      CLASS_NM: profile.classNum,
      TI_FROM_YMD: YMD,
      TI_TO_YMD: YMD
    };
    const timetableData = await fetchData('hisTimetable', timetableParams);
    if (timetableData && timetableData.hisTimetable && timetableData.hisTimetable[1].row.length > 0) {
      const timetable = timetableData.hisTimetable[1].row;
      let timetableHtml = '';
      timetable.sort((a, b) => parseInt(a.PERIO, 10) - parseInt(b.PERIO, 10)).forEach(item => {
        timetableHtml += `<div class="cell">
                            <div class="meta">
                              <div class="title">${item.PERIO}êµì‹œ: ${item.ITRT_CNTNT}</div>
                              <div class="sub">${item.CLASS_NM}ë°˜ êµì‹¤</div>
                            </div>
                          </div>`;
      });
      schoolTimetableList.innerHTML = timetableHtml;
      timetablePeriodCount.textContent = timetable.length;
    } else {
      schoolTimetableList.innerHTML = `<div class="cell"><div class="meta"><div class="title">ì‹œê°„í‘œ ì •ë³´ ì—†ìŒ</div></div></div>`;
      timetablePeriodCount.textContent = '0';
    }

    // í•™ì‚¬ì¼ì • ì •ë³´ ë¡œë“œ
    const scheduleParams = {
      ATPT_OFCDC_SC_CODE: profile.atptOfcdcScCode,
      SD_SCHUL_CODE: profile.sdSchulCode,
      AA_FROM_YMD: YM + '01',
      AA_TO_YMD: YM + '31'
    };
    const scheduleData = await fetchData('schulAcdmcrInfo', scheduleParams);
    if (scheduleData && scheduleData.schulAcdmcrInfo && scheduleData.schulAcdmcrInfo[1].row.length > 0) {
      const schedules = scheduleData.schulAcdmcrInfo[1].row.slice(0, 2); // í™ˆ í™”ë©´ì€ 2ê°œë§Œ í‘œì‹œ
      let scheduleHtml = '';
      schedules.forEach(item => {
        scheduleHtml += `<div class="cell" role="listitem">
                            <div class="avatar">${item.EVENT_NM.substring(0, 1)}</div>
                            <div class="meta">
                              <div class="title">${item.EVENT_NM}</div>
                              <div class="sub">${item.AA_YMD.replace(/(\d{4})(\d{2})(\d{2})/, '$1.$2.$3')}</div>
                            </div>
                          </div>`;
      });
      schoolScheduleList.innerHTML = scheduleHtml;

      // ì „ì²´ ì¼ì • ë¡œë“œ (í•™êµìƒí™œ í˜ì´ì§€)
      const allSchedules = scheduleData.schulAcdmcrInfo[1].row;
      let fullScheduleHtml = '';
      allSchedules.forEach(item => {
        fullScheduleHtml += `<div class="cell" role="listitem">
                            <div class="meta">
                              <div class="title">${item.EVENT_NM}</div>
                              <div class="sub">${item.AA_YMD.replace(/(\d{4})(\d{2})(\d{2})/, '$1.$2.$3')}</div>
                            </div>
                          </div>`;
      });
      schoolScheduleFullList.innerHTML = fullScheduleHtml;

    } else {
      schoolScheduleList.innerHTML = `<div class="cell"><div class="meta"><div class="title">í•™ì‚¬ì¼ì • ì •ë³´ ì—†ìŒ</div><div class="sub"></div></div></div>`;
      schoolScheduleFullList.innerHTML = `<div class="cell"><div class="meta"><div class="title">í•™ì‚¬ì¼ì • ì •ë³´ ì—†ìŒ</div><div class="sub"></div></div></div>`;
    }

  };

  // íƒ­ ë¼ìš°íŒ…
  const tabs = document.querySelectorAll('.tab');
  const pages = document.querySelectorAll('.page');
  const appTitle = document.getElementById('appTitle');

  const updatePage = (targetId) => {
    tabs.forEach(t => {
      t.classList.remove('active');
      t.setAttribute('aria-selected', 'false');
      if (t.dataset.target === targetId) {
        t.classList.add('active');
        t.setAttribute('aria-selected', 'true');
      }
    });

    pages.forEach(page => {
      if (page.id === `page-${targetId}`) {
        page.classList.add('active');
      } else {
        page.classList.remove('active');
      }
    });

    const titles = {home:'í™ˆ', school:'í•™êµìƒí™œ', community:'ì»¤ë®¤ë‹ˆí‹°', more:'ë”ë³´ê¸°'};
    appTitle.textContent = titles[targetId] || 'ì•±';
  };

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      updatePage(tab.dataset.target);
    });
  });

  // í•™êµìƒí™œ í˜ì´ì§€ ì„œë¸Œ íƒ­ ë¼ìš°íŒ…
  const schoolTabs = document.querySelectorAll('.school-tabs .chip');
  const schoolContents = {
      meal: document.getElementById('content-meal'),
      timetable: document.getElementById('content-timetable'),
      schedule: document.getElementById('content-schedule')
  };

  const updateSchoolContent = (target) => {
      schoolTabs.forEach(t => t.classList.remove('active'));
      const activeTab = document.querySelector(`.school-tabs .chip[data-target="${target}"]`);
      if (activeTab) activeTab.classList.add('active');
      Object.entries(schoolContents).forEach(([k, el]) => el.classList.toggle('hidden', k !== target));
  };

  schoolTabs.forEach(tab => {
      tab.addEventListener('click', () => {
          updateSchoolContent(tab.dataset.target);
      });
  });

  // í™ˆ í™”ë©´ ì‹œê°„í‘œ ì¹´ë“œ í´ë¦­ ì‹œ ìƒì„¸ ì‹œê°„í‘œë¡œ ì´ë™
  const timetableQuickCard = document.querySelector('.timetable-quick-card');
  if (timetableQuickCard) {
      timetableQuickCard.addEventListener('click', () => {
          updatePage('school');
          updateSchoolContent('timetable');
      });
  }

  // ë©”ì‹œì§€ íŒì—…ì„ í‘œì‹œí•˜ëŠ” ë²”ìš© í•¨ìˆ˜
  const showMessagePopup = (message) => {
      const messagePopup = document.createElement('div');
      messagePopup.textContent = message;
      messagePopup.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          padding: 16px 24px;
          background-color: rgba(0, 0, 0, 0.8);
          color: white;
          border-radius: 12px;
          z-index: 1000;
          opacity: 0;
          transition: opacity 0.3s ease-in-out;
      `;
      document.body.appendChild(messagePopup);
      
      setTimeout(() => messagePopup.style.opacity = '1', 10);
      setTimeout(() => {
          messagePopup.style.opacity = '0';
          setTimeout(() => document.body.removeChild(messagePopup), 300);
      }, 1500);
  };

  // ëª¨ë“œ í† ê¸€
  const modeToggleBtn = document.getElementById('modeToggleBtn');
  modeToggleBtn.addEventListener('click', () => {
    document.body.classList.toggle('light-mode');
    const isLightMode = document.body.classList.contains('light-mode');
    modeToggleBtn.setAttribute('aria-label', isLightMode ? 'ë‹¤í¬ëª¨ë“œë¡œ ì „í™˜' : 'ë¼ì´íŠ¸ëª¨ë“œë¡œ ì „í™˜');
  });

  // ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
  loginBtn.addEventListener('click', () => {
      showMessagePopup('ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!');
      window.location.href = '/login'; // ì‹¤ì œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
  });

  // FAB í´ë¦­ ì‹œ ë©”ì‹œì§€ í‘œì‹œ
  document.querySelector('.fab').addEventListener('click', ()=>{
    showMessagePopup('ìƒˆ ê¸€ì“°ê¸° í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!');
  });

  // ì‚¬ìš©ì í”„ë¡œí•„ ë²„íŠ¼ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ í† ê¸€
  userProfileBtn.addEventListener('click', () => {
    profileDropdown.classList.toggle('show');
  });

  // ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
  window.addEventListener('click', (e) => {
    if (!userProfileBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
      profileDropdown.classList.remove('show');
    }
  });

  // ë“œë¡­ë‹¤ìš´ ì•„ì´í…œ í´ë¦­ ì´ë²¤íŠ¸
  editProfileBtn.addEventListener('click', () => {
    showMessagePopup('í”„ë¡œí•„ í¸ì§‘ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!');
    profileDropdown.classList.remove('show');
  });

  logoutBtn.addEventListener('click', async () => {
    try {
      await signOut(auth);
      showMessagePopup('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
      profileDropdown.classList.remove('show');
    } catch (error) {
      console.error("ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:", error);
      showMessagePopup('ë¡œê·¸ì•„ì›ƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
  });

  // ë‹¬ë ¥ ëª¨ë‹¬ ë¡œì§
  const calendarModal = document.getElementById('calendarModal');
  const modalContent = document.querySelector('.modal-content');
  const todayInfoBtn = document.getElementById('today-info-btn');
  const modalCloseHandle = document.getElementById('modalCloseHandle');

  todayInfoBtn.addEventListener('click', () => {
      calendarModal.classList.add('open');
      setTimeout(() => {
          modalContent.classList.add('is-open');
      }, 10);
  });

  function closeModal() {
      modalContent.classList.remove('is-open');
      modalContent.addEventListener('transitionend', () => {
          calendarModal.classList.remove('open');
      }, { once: true });
  }

  modalCloseHandle.addEventListener('click', closeModal);
  calendarModal.addEventListener('click', (e) => {
      if (e.target.id === 'calendarModal') {
          closeModal();
      }
  });

  // ì•± ì´ˆê¸°í™”
  window.addEventListener('load', () => {
    initializeFirebase();
  });
</script>
</body>
</html>
