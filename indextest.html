<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>í•™êµìƒí™œ ì •ë³´ ì•±</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
<style>
:root{
  /* ë‹¤í¬ëª¨ë“œ í…Œë§ˆ (í† ìŠ¤ ì•± ëŠë‚Œ) */
  --brand:#6A5AF8;
  --brand-600:#5748D8;
  --brand-50:#2E265C;

  --bg:#121212;
  --surface:#1F1F1F;
  --text:#FFFFFF;
  --muted:#A9A9A9;
  --hairline:#333333;

  --radius:16px;
  --radius-sm:12px;

  --app-max:1024px;
  --app-pad:16px;
  --bar-h:56px;
  --tab-h:64px;
}

/* ë¼ì´íŠ¸ëª¨ë“œ í…Œë§ˆ (ë‹¤í¬ëª¨ë“œ ë³€ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ) */
body.light-mode {
  --bg:#F5F7FA;
  --surface:#FFFFFF;
  --text:#0F172A;
  --muted:#667085;
  --hairline:#E5E7EB;

  /* ë¼ì´íŠ¸ëª¨ë“œì—ì„œ ì¼ë¶€ ìš”ì†Œ ìƒ‰ìƒ ì¬ì •ì˜ */
  --brand:#4A90E2;
  --brand-600:#3A7ACF;
  --brand-50:#EAF2FF;
}

/* ì „ì²´ í™”ë©´ì— ì¤‘ì•™ ì•± ìº”ë²„ìŠ¤(íƒœë¸”ë¦¿) ê³ ì • */
html,body{height:100%; margin:0}
body{
  background:var(--bg);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Pretendard","Malgun Gothic",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.app-wrap{
  height:100dvh;
  display:grid; place-items:center;
  padding:calc(env(safe-area-inset-top,0px)) 0 calc(env(safe-area-inset-bottom,0px));
}
.shell{
  width:clamp(360px, 78vw, var(--app-max));
  height:100dvh;
  display:grid; grid-template-rows:var(--bar-h) 1fr var(--tab-h);
  background:var(--surface);
  border-left:1px solid var(--hairline);
  border-right:1px solid var(--hairline);
}

/* ìƒë‹¨ ì•±ë°” */
.appbar{
  display:flex; align-items:center; justify-content:space-between;
  padding:0 14px;
  border-bottom:1px solid var(--hairline);
  background:var(--surface);
}
.appbar .title{font-weight:800; letter-spacing:-0.2px}
.appbar .actions{display:flex; gap:8px; position: relative;}

/* ëª¨ë“  ë²„íŠ¼ì— í´ë¦­ íš¨ê³¼ ì ìš© */
.btn, .chip, .icon-btn, .quick-item, .fab, .card-link, .dropdown-btn {
    transition: transform 0.1s ease-in-out;
}
.btn:active, .chip:active, .icon-btn:active, .quick-item:active, .fab:active, .card-link:active, .dropdown-btn:active {
    transform: scale(0.98);
}

.btn, .chip{
  border:1px solid var(--hairline); background:var(--surface); color:var(--text);
  height:34px; padding:0 12px; border-radius:12px; font-weight:700; cursor:pointer;
}
.icon-btn{
  width:34px; height:34px; border:1px solid var(--hairline); border-radius:12px; background:var(--surface); color:var(--text); cursor:pointer;
  display: grid;
  place-items: center;
}
.material-symbols-outlined {
    font-size: 20px;
    font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 24
}
.icon-btn .moon-icon {
    display: none;
}
body.light-mode .icon-btn .sun-icon {
    display: none;
}
body.light-mode .icon-btn .moon-icon {
    display: block;
}
/* ë¼ì´íŠ¸ ëª¨ë“œì—ì„œ ì•„ì´ì½˜ ìƒ‰ìƒ ë³€ê²½ */
body.light-mode .material-symbols-outlined {
    color: var(--text);
}


/* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ: ìŠ¤í¬ë¡¤ ë°©ì§€ */
.page-container {
    width: 100%;
    height: 100%;
    overflow: hidden;
}
.page{
  display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ìˆ¨ê¹€ */
  width: 100%;
  height: 100%;
  overflow-y: auto; /* ê°œë³„ í˜ì´ì§€ ìŠ¤í¬ë¡¤ í—ˆìš© */
  padding:var(--app-pad) var(--app-pad) calc(var(--app-pad) + 24px);
  box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„/ë†’ì´ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
}
.page.active {
    display: block; /* í™œì„±í™”ëœ í˜ì´ì§€ë¥¼ í‘œì‹œ */
}

.section-title{margin:6px 2px 10px; font-weight:800; font-size:15px}
.sub{font-size:12px; color:var(--muted)}
.card-title-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.hidden{display: none;}

/* ì¹´ë“œ/ë¼ì¸: ê·¸ë¦¼ì ì—†ìŒ */
.card{
  background:var(--surface); border:1px solid var(--hairline);
  border-radius:var(--radius); padding:16px;
}
.card-link {
    display: block;
    cursor: pointer;
    text-decoration: none;
    color: inherit;
    transition: background-color 0.1s ease-in-out;
}
.card-link:hover {
    background-color: var(--hairline);
}

/* ë¦¬ìŠ¤íŠ¸ */
.list{margin-top:10px; border:1px solid var(--hairline); border-radius:14px; overflow:hidden}
.cell{display:flex; align-items:center; gap:12px; padding:14px 16px; border-bottom:1px solid var(--hairline); background:var(--surface)}
.cell:last-child{border-bottom:none}
.avatar{width:40px; height:40px; border-radius:12px; background:var(--brand-50); color:var(--brand); display:grid; place-items:center; font-weight:800}
.cell .meta{flex:1}
.title{font-weight:700}
.amount{font-weight:800}
.positive{color:#16A34A}
.negative{color:#DC2626}

/* FAB + íƒ­ë°”: ì•± íŒ¨í„´ ìœ ì§€ */
.fab{
  position:fixed;
  left:50%;
  transform:translateX(calc(-50% + min(39vw, var(--app-max)/2 - 24px)));
  bottom:calc(var(--tab-h) + 18px);
  width:56px; height:56px; border-radius:16px;
  background:var(--brand); color:#fff; display:grid; place-items:center; font-weight:800; border:0;
}
.tabbar{
  border-top:1px solid var(--hairline);
  background:rgba(31,31,31,0.96); backdrop-filter:saturate(180%) blur(8px);
}
body.light-mode .tabbar {
  background:rgba(255,255,255,0.96);
}

.tabs{height:var(--tab-h); display:grid; grid-template-columns:repeat(4,1fr)}
.tab{
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
  color:var(--muted); font-size:12px; border:0; background:transparent; cursor:pointer;
}
.tab .dot{width:6px; height:6px; border-radius:50%; background:transparent}
.tab.active{color:var(--brand)}
.tab.active .dot{background:var(--brand)}

/* ë§í¬/í¬ì»¤ìŠ¤ */
a, button{color:inherit}
:focus-visible{outline:2px solid var(--brand); outline-offset:2px; border-radius:10px}

/* ë°˜ì‘í˜•: í°ì—ì„œëŠ” 2ì—´ ê·¸ë¦¬ë“œ, íƒœë¸”ë¦¿ì€ 4ì—´ ìœ ì§€ */
@media (max-width: 560px){
  .quick-grid{grid-template-columns:repeat(2,1fr)}
}
/* ë„“ì€ ë°ìŠ¤í¬í†±ì—ì„œë„ â€˜ì•± í•œ ì¥â€™ ëŠë‚Œ ìœ ì§€ */
@media (min-width: 1400px){
  .shell{width:clamp(360px, 56vw, var(--app-max))}
}

/* iOS í™ˆ ì¸ë””ì¼€ì´í„° ì—¬ë°± */
.tabbar{padding-bottom:calc(env(safe-area-inset-bottom, 0px) + 0px);}

/* í•™êµìƒí™œ ì„œë¸Œ íƒ­ */
.school-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}
.school-tabs .chip {
    flex: 1;
    border: 1px solid var(--hairline);
    background: var(--surface);
    color: var(--muted);
    height: 40px;
    padding: 0 16px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    display: grid;
    place-items: center;
}
.school-tabs .chip.active {
    background: var(--brand-50);
    color: var(--brand);
    border-color: var(--brand-50);
}

/* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
.modal-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(0, 0, 0, 0.4);
    display: none;
    z-index: 10;
}
.modal-overlay.open {
    display: block;
}
.modal-content {
    position: absolute;
    bottom: 0; left: 0;
    width: 100%;
    max-height: 80%; /* ëª¨ë‹¬ ìµœëŒ€ ë†’ì´ ì„¤ì • */
    overflow-y: auto; /* ë‚´ìš©ì´ ë„˜ì¹˜ë©´ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
    background: var(--surface);
    border-top-left-radius: var(--radius);
    border-top-right-radius: var(--radius);
    padding: 16px;
    transform: translateY(100%);
    transition: transform 0.3s ease-in-out;
    box-sizing: border-box; /* íŒ¨ë”©ì´ ë„ˆë¹„/ë†’ì´ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
}
.modal-content.is-open {
    transform: translateY(0);
}
.modal-close-handle {
    width: 40px;
    height: 4px;
    background-color: var(--muted);
    border-radius: 2px;
    margin: 0 auto 16px;
    cursor: pointer;
}

/* ë‹¬ë ¥ ìŠ¤íƒ€ì¼ */
.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}
.calendar-header .month-year {
    font-size: 18px;
    font-weight: 700;
}
.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    gap: 8px;
}
.calendar-grid .day {
    padding: 8px;
    font-weight: 500;
    border-radius: 50%;
    cursor: pointer;
}
.calendar-grid .day.today {
    background: var(--brand);
    color: white;
}
.calendar-grid .weekday {
    font-weight: 700;
    color: var(--muted);
}

/* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
body::-webkit-scrollbar,
.page::-webkit-scrollbar,
.modal-content::-webkit-scrollbar {
    width: 6px;
}

body::-webkit-scrollbar-thumb,
.page::-webkit-scrollbar-thumb,
.modal-content::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
}

body.light-mode::-webkit-scrollbar-thumb,
.page.light-mode::-webkit-scrollbar-thumb,
.modal-content.light-mode::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.2);
}

body::-webkit-scrollbar-track,
.page::-webkit-scrollbar-track,
.modal-content::-webkit-scrollbar-track {
    background: transparent;
}

/* ì»¤ë®¤ë‹ˆí‹° ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
.community-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin-top: 10px;
}

.community-item {
  border: 1px solid var(--hairline);
  background: var(--surface);
  border-radius: var(--radius);
  padding: 14px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.community-item .category {
    font-size: 12px;
    color: var(--brand);
}

.community-item .post-title {
    font-weight: 700;
    font-size: 15px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    word-break: break-word;
}

.community-item .preview {
    font-size: 13px;
    line-height: 1.4;
    color: var(--muted);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    word-break: break-word;
}

.community-item .meta {
    font-size: 12px;
    color: var(--muted);
    margin-top: auto;
}

/* ì‚¬ìš©ì ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ìŠ¤íƒ€ì¼ */
.user-dropdown-container {
    position: relative;
    display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
}

.user-dropdown-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    border: 1px solid var(--hairline);
    background: var(--surface);
    color: var(--text);
    height: 34px;
    padding: 0 12px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
}

.user-dropdown-menu {
    position: absolute;
    top: 40px;
    right: 0;
    width: 150px;
    background: var(--surface);
    border: 1px solid var(--hairline);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: 20;
    display: none;
    flex-direction: column;
    overflow: hidden;
}

.user-dropdown-menu.active {
    display: flex;
}

.user-dropdown-menu button {
    background: transparent;
    border: none;
    color: var(--text);
    padding: 12px 16px;
    text-align: left;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.1s ease-in-out;
}

.user-dropdown-menu button:hover {
    background-color: var(--hairline);
}
</style>
</head>
<body>
  <div class="app-wrap">
    <div class="shell" aria-label="ì•± ìº”ë²„ìŠ¤">

      <!-- ì•±ë°” -->
      <header class="appbar">
        <div class="title" id="appTitle">í™ˆ</div>
        <div class="actions">
          <!-- ë¡œê·¸ì¸ ë²„íŠ¼ -->
          <a href="/login" class="btn" id="loginBtn">ë¡œê·¸ì¸</a>

          <!-- ì‚¬ìš©ì ë“œë¡­ë‹¤ìš´ (ë¡œê·¸ì¸ ì‹œ í‘œì‹œ) -->
          <div class="user-dropdown-container" id="userDropdownContainer">
              <button class="user-dropdown-btn" id="userDropdownBtn">
                  <span id="userName">ì‚¬ìš©ì</span>
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
              </button>
              <div class="user-dropdown-menu" id="userDropdownMenu">
                  <button id="editProfileBtn">í”„ë¡œí•„ í¸ì§‘</button>
                  <button id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
              </div>
          </div>
          <button class="icon-btn" id="modeToggleBtn" aria-label="ë¼ì´íŠ¸ëª¨ë“œ/ë‹¤í¬ëª¨ë“œ í† ê¸€">
            <span class="material-symbols-outlined sun-icon">light_mode</span>
            <span class="material-symbols-outlined moon-icon">dark_mode</span>
          </button>
        </div>
      </header>
      
      <!-- í˜ì´ì§€ ì»¨í…Œì´ë„ˆ -->
      <div class="page-container" id="pageContainer">
        <!-- í˜ì´ì§€: í™ˆ -->
        <main class="page active" id="page-home" role="region" aria-label="í™ˆ">
          <section class="card">
            <div class="card-title-row">
                <div class="section-title">ì˜¤ëŠ˜ì˜ í•™êµìƒí™œ</div>
                <button id="today-info-btn" class="icon-btn" aria-label="ì˜¤ëŠ˜ì˜ í•™êµìƒí™œ ì •ë³´ ë”ë³´ê¸°">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
            </div>
            <div class="sub">ì˜¤ëŠ˜ì˜ ê¸‰ì‹ê³¼ ì‹œê°„í‘œë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>
            <div style="margin-top:10px; display:grid; gap:10px; grid-template-columns:repeat(2,1fr)">
              <div class="card" style="padding:12px">
                <div class="title">ì ì‹¬ ê¸‰ì‹</div>
                <div class="sub" style="margin-top:4px" id="mealMenu">ê¸‰ì‹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
              </div>
              <div class="card card-link timetable-quick-card" style="padding:12px">
                <div class="title">ì˜¤ëŠ˜ì˜ ì‹œê°„í‘œ</div>
                <div class="sub" style="margin-top:4px" id="timetableInfo">ì‹œê°„í‘œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
              </div>
            </div>
          </section>

          <div class="card-title-row">
              <h3 class="section-title">ì»¤ë®¤ë‹ˆí‹° ìƒˆ ì†Œì‹ ğŸ”¥</h3>
              <button class="btn" style="height:28px">ë”ë³´ê¸°</button>
          </div>
          <div class="community-grid" role="region" aria-label="ì»¤ë®¤ë‹ˆí‹° ìµœì‹  ê¸€">
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ë´‰ì‚¬í™œë™ ì‹ ì²­ ì•ˆë‚´</div>
                  <div class="preview">ì´ë²ˆ í•™ê¸° ë´‰ì‚¬í™œë™ ì‹ ì²­ì„ 6ì›” 25ì¼ê¹Œì§€ ë°›ìŠµë‹ˆë‹¤. ì‹ ì²­ì„œ ì–‘ì‹ì€ í•™ìƒíšŒê´€ 2ì¸µ ê²Œì‹œíŒì—ì„œ í™•ì¸í•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì´ì¢…í˜„ Â· 4ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">í•™êµ ì¶•ì œ ì•„ì´ë””ì–´ ê³µëª¨</div>
                  <div class="preview">ë‹¤ê°€ì˜¤ëŠ” ê°€ì„ ì¶•ì œ 'í•˜ë‚˜ ë˜ëŠ” ìš°ë¦¬'ì˜ ì•„ì´ë””ì–´ë¥¼ ê³µëª¨í•©ë‹ˆë‹¤! ê³µì—°, ë¶€ìŠ¤, ì´ë²¤íŠ¸ ë“± ììœ ë¡­ê²Œ ì œì•ˆí•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì½”ì½”ëª½ Â· 9ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ê¸°ìˆ™ì‚¬ìƒ ì™¸ë°• ì‹ ì²­ ì•ˆë‚´</div>
                  <div class="preview">ì—¬ë¦„ë°©í•™ ê¸°ê°„ ë™ì•ˆ ê¸°ìˆ™ì‚¬ ì™¸ë°•ì„ í¬ë§í•˜ëŠ” í•™ìƒë“¤ì€ 7ì›” 5ì¼ê¹Œì§€ ì‹ ì²­í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</div>
                  <div class="meta">ì˜¤ë Œì§€ Â· 13ì¼ ì „</div>
              </div>
              <div class="community-item">
                  <div class="category">#ììœ ê²Œì‹œíŒ</div>
                  <div class="post-title">ì²´ìœ¡ëŒ€íšŒ ì¢…ëª© íˆ¬í‘œ</div>
                  <div class="preview">ì˜¬í•´ ì²´ìœ¡ëŒ€íšŒì—ì„œ ì§„í–‰í•  ì¢…ëª©ì„ íˆ¬í‘œë¡œ ê²°ì •í•©ë‹ˆë‹¤. ë†êµ¬, í”¼êµ¬, ì´ì–´ë‹¬ë¦¬ê¸° ë“± ì„ í˜¸í•˜ëŠ” ì¢…ëª©ì— íˆ¬í‘œí•´ ì£¼ì„¸ìš”.</div>
                  <div class="meta">ì²´ìœ¡ë¶€ Â· 18ì¼ ì „</div>
              </div>
          </div>

          <h3 class="section-title">ë‹¤ê°€ì˜¤ëŠ” í•™ì‚¬ì¼ì •</h3>
          <div class="list" role="list">
            <div class="cell" role="listitem">
              <div class="avatar">ê¸°</div>
              <div class="meta">
                <div class="title">ê¸°ë§ê³ ì‚¬ ì‹œì‘</div>
                <div class="sub">2025.07.01</div>
              </div>
            </div>
            <div class="cell" role="listitem">
              <div class="avatar">ì—¬</div>
              <div class="meta">
                <div class="title">ì—¬ë¦„ë°©í•™ì‹</div>
                <div class="sub">2025.07.10</div>
              </div>
            </div>
          </div>
        </main>

        <!-- í˜ì´ì§€: í•™êµìƒí™œ -->
        <main class="page" id="page-school" role="region" aria-label="í•™êµìƒí™œ">
          <div class="school-tabs">
            <button class="chip active" data-target="meal">ê¸‰ì‹</button>
            <button class="chip" data-target="timetable">ì‹œê°„í‘œ</button>
            <button class="chip" data-target="schedule">í•™ì‚¬ì¼ì •</button>
          </div>
          
          <div id="content-meal">
              <section class="card">
                  <div class="section-title">ê¸‰ì‹</div>
                  <div class="sub">ì˜¤ëŠ˜ì˜ ì ì‹¬ ë©”ë‰´</div>
                  <div style="margin-top:10px;">
                      <div class="list">
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">ì ì‹¬</div>
                                  <div class="sub" id="schoolMealMenu">ê¸‰ì‹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>

          <!-- initially hidden -->
          <div id="content-timetable" class="hidden">
              <section class="card">
                  <div class="section-title">ì‹œê°„í‘œ</div>
                  <div class="sub">ì˜¤ëŠ˜ì˜ ìˆ˜ì—… ì‹œê°„í‘œ</div>
                  <div style="margin-top:10px;">
                      <div class="list" id="schoolTimetable">
                          <!-- Nice API data will be inserted here -->
                      </div>
                  </div>
              </section>
          </div>

          <!-- initially hidden -->
          <div id="content-schedule" class="hidden">
              <section class="card">
                  <div class="section-title">í•™ì‚¬ì¼ì •</div>
                  <div class="sub">ë‹¤ê°€ì˜¤ëŠ” ì£¼ìš” ì¼ì •</div>
                  <div style="margin-top:10px;">
                      <div class="list">
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">7ì›” 1ì¼</div>
                                  <div class="sub">ê¸°ë§ê³ ì‚¬ ì‹œì‘</div>
                              </div>
                          </div>
                          <div class="cell">
                              <div class="meta">
                                  <div class="title">7ì›” 10ì¼</div>
                                  <div class="sub">ì—¬ë¦„ë°©í•™ì‹</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </section>
          </div>
        </main>

        <!-- í˜ì´ì§€: ì»¤ë®¤ë‹ˆí‹° -->
        <main class="page" id="page-community" role="region" aria-label="ì»¤ë®¤ë‹ˆí‹°">
          <section class="card">
            <div class="section-title">ì»¤ë®¤ë‹ˆí‹°</div>
            <div class="sub">ììœ  ê²Œì‹œíŒ, ë™ì•„ë¦¬</div>
            <div style="margin-top:10px; border:1px dashed var(--hairline); border-radius:12px; padding:16px; text-align:center;">
              <p style="color:var(--muted)">ë‹¤ì–‘í•œ ì†Œì‹ì„ ê³µìœ í•´ë³´ì„¸ìš”!</p>
              <button class="chip" style="margin-top:12px; background:var(--brand); color:white; border-color:var(--brand);">ê¸€ì“°ê¸°</button>
            </div>
          </section>
        </main>

        <!-- í˜ì´ì§€: ë”ë³´ê¸° -->
        <main class="page" id="page-more" role="region" aria-label="ë”ë³´ê¸°">
          <section class="card">
            <div class="section-title">ë”ë³´ê¸°</div>
            <div class="sub">ì„¤ì •, ì •ë³´, ê³ ê°ì„¼í„°</div>
            <div style="margin-top:10px; display:grid; grid-template-columns:repeat(3,1fr); gap:10px">
              <button class="quick-item"><div class="quick-ico">ì„¤</div><div>ì„¤ì •</div></button>
              <button class="quick-item"><div class="quick-ico">ê³µ</div><div>ê³µì§€ì‚¬í•­</div></button>
              <button class="quick-item"><div class="quick-ico">ë„</div><div>ë„ì›€ë§</div></button>
            </div>
          </section>
        </main>
      </div>

      <!-- í•˜ë‹¨ íƒ­ë°” -->
      <nav class="tabbar" role="tablist" aria-label="í•˜ë‹¨ ë‚´ë¹„ê²Œì´ì…˜">
        <div class="tabs">
          <button class="tab active" data-target="home" role="tab" aria-selected="true">í™ˆ<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="school" role="tab" aria-selected="false">í•™êµìƒí™œ<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="community" role="tab" aria-selected="false">ì»¤ë®¤ë‹ˆí‹°<span class="dot" aria-hidden="true"></span></button>
          <button class="tab" data-target="more" role="tab" aria-selected="false">ë”ë³´ê¸°<span class="dot" aria-hidden="true"></span></button>
        </div>
      </nav>

      <!-- FAB -->
      <button class="fab" aria-label="ìƒˆ ê¸€ì“°ê¸°">ï¼‹</button>
    </div>
  </div>

  <!-- ë‹¬ë ¥ ëª¨ë‹¬ -->
  <div class="modal-overlay" id="calendarModal">
    <div class="modal-content">
        <div class="modal-close-handle" id="modalCloseHandle"></div>
        <div class="calendar-header">
            <button class="icon-btn prev-month">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7z"/></svg>
            </button>
            <span class="month-year">2025ë…„ 9ì›”</span>
            <button class="icon-btn next-month">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M10 6l-6 6 6 6z" transform="rotate(180 12 12)"/></svg>
            </button>
        </div>
        <div class="calendar-grid">
            <span class="weekday" style="color:#DC2626">ì¼</span>
            <span class="weekday">ì›”</span>
            <span class="weekday">í™”</span>
            <span class="weekday">ìˆ˜</span>
            <span class="weekday">ëª©</span>
            <span class="weekday">ê¸ˆ</span>
            <span class="weekday" style="color:#4A90E2">í† </span>
            <span class="day muted">31</span>
            <span class="day">1</span>
            <span class="day">2</span>
            <span class="day">3</span>
            <span class="day">4</span>
            <span class="day">5</span>
            <span class="day">6</span>
            <span class="day">7</span>
            <span class="day">8</span>
            <span class="day">9</span>
            <span class="day">10</span>
            <span class="day">11</span>
            <span class="day">12</span>
            <span class="day">13</span>
            <span class="day">14</span>
            <span class="day">15</span>
            <span class="day">16</span>
            <span class="day">17</span>
            <span class="day">18</span>
            <span class="day">19</span>
            <span class="day">20</span>
            <span class="day">21</span>
            <span class="day">22</span>
            <span class="day">23</span>
            <span class="day">24</span>
            <span class="day">25</span>
            <span class="day">26</span>
            <span class="day">27</span>
            <span class="day">28</span>
            <span class="day">29</span>
            <span class="day">30</span>
        </div>
    </div>
  </div>

<script type="module">
  // Firebase SDK imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  // Global variables provided by the Canvas environment
  const __app_id = "n-mate";
  const __firebase_config = { 
    apiKey: "AIzaSyC_SHRcQ9hXmjVbP3km4rdR4UvKIoqpLHo", 
    authDomain: "n-mate.firebaseapp.com", 
    projectId: "n-mate", 
    storageBucket: "n-mate.firebasestorage.app", 
    messagingSenderId: "691313471077", 
    appId: "1:691313471077:web:3066aaeca0a1d9e448e08c", 
    measurementId: "G-0LCGVBKXLQ" 
  };
  const __initial_auth_token = "eyJhbGciOiJSUzI1NiIsImtpZCI6IjY3MzI2YTgzNTU5ZmRlOWI5MDdhNTNhZjczYzQ2OTJmMzEyZmE5YjMiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vb2t0LWxhYi1naXRodWItMjAyNCIsImF1ZCI6Im9rdC1sYWItZ2l0aHViLTIwMjQiLCJhdXRoX3RpbWUiOjE3MTgzNjU1NDIsInVzZXJfaWQiOiJmZ015TW4zbGdkWXZFOHd4eEZlVzI4a1J4V2ExIiwic3ViIjoiZmdNeU1uM2xnZFl2RTh3eHhGZVcyOGtSeFdhMSIsImlhdCI6MTcxODM2NTU1NSwiZXhwIjoxNzE4MzY5MTU1LCJmaXJlYmFzZSI6eyJpZGVudGl0aWVzIjp7fSwic2lnbl9pbl9wcm92aWRlciI6ImN1c3RvbSJ9fQ.M65y8wQ2iW-uLp3P1-5Jq2s-5j9Kq2pL0oXo5-1g1U9e1g-9g1U9e1g1U-9g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1U9e1g1-
>  
<script type="module">
  // Firebase SDK imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
  
  // Global variables provided by the Canvas environment
  const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
  const firebaseConfig = JSON.parse(__firebase_config);
  
  // Set up Firebase and Firestore
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);
  setLogLevel('debug'); // Enable Firestore debug logs

  // Nice API key (Note: This is a placeholder and should be handled securely in a production app)
  const NICE_API_KEY = "cbb4da48e87445f68c2732368454ebc3";

  // UI elements
  const loginBtn = document.getElementById('loginBtn');
  const userDropdownContainer = document.getElementById('userDropdownContainer');
  const userDropdownBtn = document.getElementById('userDropdownBtn');
  const userDropdownMenu = document.getElementById('userDropdownMenu');
  const userNameEl = document.getElementById('userName');
  const logoutBtn = document.getElementById('logoutBtn');
  const editProfileBtn = document.getElementById('editProfileBtn');
  const mealMenuEl = document.getElementById('mealMenu');
  const schoolMealMenuEl = document.getElementById('schoolMealMenu');
  const timetableInfoEl = document.getElementById('timetableInfo');
  const schoolTimetableEl = document.getElementById('schoolTimetable');

  // Utility function for displaying messages
  const showMessagePopup = (message) => {
    const messagePopup = document.createElement('div');
    messagePopup.textContent = message;
    messagePopup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 16px 24px;
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        border-radius: 12px;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
    `;
    document.body.appendChild(messagePopup);
    setTimeout(() => messagePopup.style.opacity = '1', 10);
    setTimeout(() => {
        messagePopup.style.opacity = '0';
        setTimeout(() => document.body.removeChild(messagePopup), 300);
    }, 1500);
  };

  /**
   * Firebase Firestoreì—ì„œ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
   * @param {object} user - Firebase User ê°ì²´
   */
  async function fetchUserData(user) {
    if (!user) return;
    try {
      const userRef = doc(db, `artifacts/${appId}/users/${user.uid}/profile/user_data`);
      const userSnap = await getDoc(userRef);

      if (userSnap.exists()) {
        const userData = userSnap.data();
        console.log("Firebase ì‚¬ìš©ì ë°ì´í„° ê²€ìƒ‰ ì™„ë£Œ:", userData);

        // UIì— ì‚¬ìš©ì ì´ë¦„ ì—…ë°ì´íŠ¸
        userNameEl.textContent = userData.name || "ì‚¬ìš©ì";

        // ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ Nice API í˜¸ì¶œ
        fetchNiceAPIData(userData.atptOfcdcScCode, userData.sdSchulCode, userData.grade, userData.classNum);
      } else {
        console.log("Firestoreì—ì„œ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        showMessagePopup("í”„ë¡œí•„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”.");
        userNameEl.textContent = "ìƒˆ ì‚¬ìš©ì";
      }
    } catch (error) {
      console.error("ì‚¬ìš©ì ë°ì´í„° ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
      showMessagePopup("ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    }
  }

  /**
   * Nice APIì—ì„œ ê¸‰ì‹ ë° ì‹œê°„í‘œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ (ëª¨ì˜)
   * ì‹¤ì œ API í˜¸ì¶œì€ ì—¬ê¸°ì— êµ¬í˜„í•˜ë©´ ë©ë‹ˆë‹¤.
   * @param {string} atptOfcdcScCode - ì‹œë„êµìœ¡ì²­ ì½”ë“œ
   * @param {string} sdSchulCode - í•™êµ ì½”ë“œ
   * @param {number} grade - í•™ë…„
   * @param {number} classNum - ë°˜
   */
  const fetchNiceAPIData = (atptOfcdcScCode, sdSchulCode, grade, classNum) => {
    console.log(`Nice API key: ${NICE_API_KEY}`);
    console.log(`Nice API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜ - ë§¤ê°œë³€ìˆ˜: 
        ì‹œë„êµìœ¡ì²­ ì½”ë“œ: ${atptOfcdcScCode}, 
        í•™êµ ì½”ë“œ: ${sdSchulCode},
        í•™ë…„: ${grade},
        ë°˜: ${classNum}`);

    // Nice API í˜•ì‹ì— ë”°ë¥¸ ëª¨ì˜ ë°ì´í„°
    const mockMealData = {
      mealServiceDietInfo: [
        {
          head: [{
            list_total_count: 1
          }, {
            RESULT: {
              CODE: "INFO-000",
              MESSAGE: "ì •ìƒ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤."
            }
          }],
          row: [{
            DDISH_NM: "í˜¼í•©ì¡ê³¡ë°¥, ë¼ì§€ê³ ê¸°ê¹€ì¹˜ì°Œê°œ, ë‹­ë³¶ìŒíƒ•, ì˜¤ì§•ì–´ì±„ë³¶ìŒ, ë°°ì¶”ê¹€ì¹˜, ì°ë¹µ"
          }]
        }
      ]
    };

    const mockTimetableData = {
      elsTimetable: [
        {
          head: [{
            list_total_count: 6
          }, {
            RESULT: {
              CODE: "INFO-000",
              MESSAGE: "ì •ìƒ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤."
            }
          }],
          row: [{
            PERIO: 1,
            ITRT_CHTNM: "êµ­ì–´"
          }, {
            PERIO: 2,
            ITRT_CHTNM: "ìˆ˜í•™"
          }, {
            PERIO: 3,
            ITRT_CHTNM: "ì˜ì–´"
          }, {
            PERIO: 4,
            ITRT_CHTNM: "ê³¼í•™"
          }, {
            PERIO: 5,
            ITRT_CHTNM: "ë¯¸ìˆ "
          }, {
            PERIO: 6,
            ITRT_CHTNM: "ì²´ìœ¡"
          }]
        }
      ]
    };
    
    // ëª¨ì˜ ê¸‰ì‹ ë°ì´í„° ì²˜ë¦¬
    const meal = mockMealData.mealServiceDietInfo[0].row[0].DDISH_NM;
    const formattedMeal = meal.replace(/ /g, ', ').replace(/,/g, ', '); 
    
    // UI ì—…ë°ì´íŠ¸
    mealMenuEl.textContent = formattedMeal;
    schoolMealMenuEl.textContent = formattedMeal;
    
    // ëª¨ì˜ ì‹œê°„í‘œ ë°ì´í„° ì²˜ë¦¬
    const timetable = mockTimetableData.elsTimetable[0].row;
    let timetableHtml = '';
    let periods = 0;
    timetable.forEach(item => {
      timetableHtml += `
        <div class="cell">
          <div class="meta">
            <div class="title">${item.PERIO}êµì‹œ</div>
            <div class="sub">${item.ITRT_CHTNM} (${grade}í•™ë…„ ${classNum}ë°˜ êµì‹¤)</div>
          </div>
        </div>`;
      periods++;
    });

    timetableInfoEl.textContent = `ì´ ${periods}êµì‹œ`;
    schoolTimetableEl.innerHTML = timetableHtml;
  };

  // Auth state change listener
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      // ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ë¨
      loginBtn.style.display = 'none';
      userDropdownContainer.style.display = 'block';
      await fetchUserData(user);
    } else {
      // ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒë¨
      loginBtn.style.display = 'block';
      userDropdownContainer.style.display = 'none';
      userNameEl.textContent = "ì‚¬ìš©ì";
    }
  });

  // ì‚¬ìš©ì ì •ì˜ í† í°ìœ¼ë¡œ ì´ˆê¸° ë¡œê·¸ì¸
  if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token !== null) {
      signInWithCustomToken(auth, __initial_auth_token).catch((error) => {
          console.error("Custom token sign-in failed:", error);
      });
  } else {
      console.warn("ì‚¬ìš©ì ì •ì˜ í† í°ì´ ì œê³µë˜ì§€ ì•Šì•„ ë¡œê·¸ì¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.");
  }

  // Event Listeners for the new UI elements
  userDropdownBtn.addEventListener('click', () => {
      userDropdownMenu.classList.toggle('active');
  });

  logoutBtn.addEventListener('click', () => {
      signOut(auth).then(() => {
          console.log("User signed out.");
          showMessagePopup("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
      }).catch((error) => {
          console.error("Sign out error:", error);
          showMessagePopup("ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      });
  });

  editProfileBtn.addEventListener('click', () => {
      showMessagePopup("í”„ë¡œí•„ í¸ì§‘ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!");
      // In a real app, you would navigate here
      userDropdownMenu.classList.remove('active');
  });

  // Close dropdown when clicking outside
  window.addEventListener('click', (event) => {
      if (!userDropdownContainer.contains(event.target)) {
          userDropdownMenu.classList.remove('active');
      }
  });

  // íƒ­ ë¼ìš°íŒ…
  const tabs = document.querySelectorAll('.tab');
  const pages = document.querySelectorAll('.page');
  const appTitle = document.getElementById('appTitle');

  const updatePage = (targetId) => {
    // íƒ­ í™œì„±í™” ìƒíƒœ ë³€ê²½
    tabs.forEach(t => {
      t.classList.remove('active');
      t.setAttribute('aria-selected', 'false');
      if (t.dataset.target === targetId) {
        t.classList.add('active');
        t.setAttribute('aria-selected', 'true');
      }
    });

    // í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½
    pages.forEach(page => {
      if (page.id === `page-${targetId}`) {
        page.classList.add('active');
      } else {
        page.classList.remove('active');
      }
    });

    // ì•±ë°” íƒ€ì´í‹€ ë³€ê²½
    const titles = {home:'í™ˆ', school:'í•™êµìƒí™œ', community:'ì»¤ë®¤ë‹ˆí‹°', more:'ë”ë³´ê¸°'};
    appTitle.textContent = titles[targetId] || 'ì•±';
  };

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      updatePage(tab.dataset.target);
    });
  });

  // í•™êµìƒí™œ í˜ì´ì§€ ì„œë¸Œ íƒ­ ë¼ìš°íŒ…
  const schoolTabs = document.querySelectorAll('.school-tabs .chip');
  const schoolContents = {
      meal: document.getElementById('content-meal'),
      timetable: document.getElementById('content-timetable'),
      schedule: document.getElementById('content-schedule')
  };

  const updateSchoolContent = (target) => {
      schoolTabs.forEach(t => t.classList.remove('active'));
      const activeTab = document.querySelector(`.school-tabs .chip[data-target="${target}"]`);
      if (activeTab) activeTab.classList.add('active');
      Object.entries(schoolContents).forEach(([k, el]) => el.classList.toggle('hidden', k !== target));
  };

  schoolTabs.forEach(tab => {
      tab.addEventListener('click', () => {
          updateSchoolContent(tab.dataset.target);
      });
  });

  // í™ˆ í™”ë©´ ì‹œê°„í‘œ ì¹´ë“œ í´ë¦­ ì‹œ ìƒì„¸ ì‹œê°„í‘œë¡œ ì´ë™
  const timetableQuickCard = document.querySelector('.timetable-quick-card');
  if (timetableQuickCard) {
      timetableQuickCard.addEventListener('click', () => {
          updatePage('school');
          updateSchoolContent('timetable');
      });
  }

  // ëª¨ë“œ í† ê¸€
  const modeToggleBtn = document.getElementById('modeToggleBtn');
  modeToggleBtn.addEventListener('click', () => {
    document.body.classList.toggle('light-mode');
    const isLightMode = document.body.classList.contains('light-mode');
    modeToggleBtn.setAttribute('aria-label', isLightMode ? 'ë‹¤í¬ëª¨ë“œë¡œ ì „í™˜' : 'ë¼ì´íŠ¸ëª¨ë“œë¡œ ì „í™˜');
  });

  // FAB í´ë¦­ ì‹œ ë©”ì‹œì§€ í‘œì‹œ
  document.querySelector('.fab').addEventListener('click', ()=>{
    showMessagePopup('ìƒˆ ê¸€ì“°ê¸° í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤!');
  });

  // ë‹¬ë ¥ ëª¨ë‹¬ ë¡œì§
  const calendarModal = document.getElementById('calendarModal');
  const modalContent = document.querySelector('.modal-content');
  const todayInfoBtn = document.getElementById('today-info-btn');
  const modalCloseHandle = document.getElementById('modalCloseHandle');

  todayInfoBtn.addEventListener('click', () => {
      calendarModal.classList.add('open');
      setTimeout(() => {
          modalContent.classList.add('is-open');
      }, 10);
  });

  function closeModal() {
      modalContent.classList.remove('is-open');
      modalContent.addEventListener('transitionend', () => {
          calendarModal.classList.remove('open');
      }, { once: true });
  }

  modalCloseHandle.addEventListener('click', closeModal);
  calendarModal.addEventListener('click', (e) => {
      if (e.target.id === 'calendarModal') {
          closeModal();
      }
  });

</script>
</body>
</html>
